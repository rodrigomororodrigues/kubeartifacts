{"format_version":"1.2","terraform_version":"1.5.5","variables":{"acr_admin_enabled":{"value":true},"acr_georeplication_locations":{"value":[]},"acr_name":{"value":"Acr"},"acr_sku":{"value":"Premium"},"admin_group_object_ids":{"value":["XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"]},"admin_username":{"value":"azadmin"},"aks_cluster_name":{"value":"Aks"},"automatic_channel_upgrade":{"value":"stable"},"azure_policy_enabled":{"value":true},"azure_rbac_enabled":{"value":true},"bastion_host_name":{"value":"BastionHost"},"bastion_subnet_address_prefix":{"value":["10.243.2.0/24"]},"deployment_script_azure_cli_version":{"value":"2.9.1"},"deployment_script_managed_identity_name":{"value":"ScriptManagedIdentity"},"deployment_script_name":{"value":"BashScript"},"deployment_script_primary_script_uri":{"value":"https://paolosalvatori.blob.core.windows.net/scripts/install-nginx-via-helm-and-create-sa.sh"},"domain":{"value":"contoso.com"},"email":{"value":"paolos@microsoft.com"},"http_application_routing_enabled":{"value":false},"image_cleaner_enabled":{"value":true},"keda_enabled":{"value":true},"key_vault_bypass":{"value":"AzureServices"},"key_vault_default_action":{"value":"Allow"},"key_vault_enable_rbac_authorization":{"value":true},"key_vault_enabled_for_deployment":{"value":true},"key_vault_enabled_for_disk_encryption":{"value":true},"key_vault_enabled_for_template_deployment":{"value":true},"key_vault_name":{"value":"KeyVault"},"key_vault_purge_protection_enabled":{"value":false},"key_vault_sku_name":{"value":"standard"},"key_vault_soft_delete_retention_days":{"value":30},"kubernetes_version":{"value":"1.26.3"},"location":{"value":"East US"},"log_analytics_retention_days":{"value":30},"log_analytics_workspace_name":{"value":"Workspace"},"name_prefix":{"value":"magic8ball"},"namespace":{"value":"magic8ball"},"nat_gateway_idle_timeout_in_minutes":{"value":4},"nat_gateway_name":{"value":"NatGateway"},"nat_gateway_sku_name":{"value":"Standard"},"nat_gateway_zones":{"value":["1"]},"network_dns_service_ip":{"value":"10.2.0.10"},"network_plugin":{"value":"azure"},"network_service_cidr":{"value":"10.2.0.0/24"},"oidc_issuer_enabled":{"value":true},"open_service_mesh_enabled":{"value":true},"openai_custom_subdomain_name":{"value":""},"openai_deployments":{"value":[{"model":{"name":"gpt-35-turbo","version":"0301"},"name":"gpt-35-turbo","rai_policy_name":""}]},"openai_name":{"value":"OpenAi"},"openai_public_network_access_enabled":{"value":true},"openai_sku_name":{"value":"S0"},"pod_subnet_address_prefix":{"value":["10.242.0.0/16"]},"pod_subnet_name":{"value":"PodSubnet"},"private_cluster_enabled":{"value":false},"resource_group_name":{"value":"RG"},"role_based_access_control_enabled":{"value":true},"service_account_name":{"value":"magic8ball-sa"},"sku_tier":{"value":"Free"},"solution_plan_map":{"value":{"ContainerInsights":{"product":"OMSGallery/ContainerInsights","publisher":"Microsoft"}}},"ssh_public_key":{"value":"XXXXXXX"},"storage_account_kind":{"value":"StorageV2"},"storage_account_replication_type":{"value":"LRS"},"storage_account_tier":{"value":"Standard"},"subdomain":{"value":"magic"},"system_node_pool_availability_zones":{"value":["1","2","3"]},"system_node_pool_enable_auto_scaling":{"value":true},"system_node_pool_enable_host_encryption":{"value":false},"system_node_pool_enable_node_public_ip":{"value":false},"system_node_pool_max_count":{"value":10},"system_node_pool_max_pods":{"value":50},"system_node_pool_min_count":{"value":3},"system_node_pool_name":{"value":"system"},"system_node_pool_node_count":{"value":3},"system_node_pool_node_labels":{"value":{}},"system_node_pool_node_taints":{"value":[]},"system_node_pool_os_disk_type":{"value":"Ephemeral"},"system_node_pool_subnet_address_prefix":{"value":["10.240.0.0/16"]},"system_node_pool_subnet_name":{"value":"SystemSubnet"},"system_node_pool_vm_size":{"value":"Standard_F8s_v2"},"tags":{"value":{"createdWith":"Terraform"}},"user_node_pool_availability_zones":{"value":["1","2","3"]},"user_node_pool_enable_auto_scaling":{"value":true},"user_node_pool_enable_host_encryption":{"value":false},"user_node_pool_enable_node_public_ip":{"value":false},"user_node_pool_max_count":{"value":10},"user_node_pool_max_pods":{"value":50},"user_node_pool_min_count":{"value":3},"user_node_pool_mode":{"value":"User"},"user_node_pool_name":{"value":"user"},"user_node_pool_node_count":{"value":3},"user_node_pool_node_labels":{"value":{}},"user_node_pool_node_taints":{"value":["CriticalAddonsOnly=true:NoSchedule"]},"user_node_pool_os_disk_type":{"value":"Ephemeral"},"user_node_pool_os_type":{"value":"Linux"},"user_node_pool_priority":{"value":"Regular"},"user_node_pool_subnet_address_prefix":{"value":["10.241.0.0/16"]},"user_node_pool_subnet_name":{"value":"UserSubnet"},"user_node_pool_vm_size":{"value":"Standard_F8s_v2"},"vertical_pod_autoscaler_enabled":{"value":true},"vm_enabled":{"value":true},"vm_name":{"value":"Vm"},"vm_os_disk_image":{"value":{"offer":"0001-com-ubuntu-server-jammy","publisher":"Canonical","sku":"22_04-lts-gen2","version":"latest"}},"vm_os_disk_storage_account_type":{"value":"Premium_LRS"},"vm_public_ip":{"value":false},"vm_size":{"value":"Standard_DS1_v2"},"vm_subnet_address_prefix":{"value":["10.243.1.0/24"]},"vm_subnet_name":{"value":"VmSubnet"},"vnet_address_space":{"value":["10.0.0.0/8"]},"vnet_name":{"value":"AksVNet"},"workload_identity_enabled":{"value":true},"workload_managed_identity_name":{"value":"WorkloadManagedIdentity"}},"planned_values":{"root_module":{"resources":[{"address":"random_string.prefix","mode":"managed","type":"random_string","name":"prefix","provider_name":"registry.terraform.io/hashicorp/random","schema_version":2,"values":{"keepers":null,"length":6,"lower":true,"min_lower":0,"min_numeric":0,"min_special":0,"min_upper":0,"number":false,"numeric":false,"override_special":null,"special":false,"upper":false},"sensitive_values":{}},{"address":"random_string.storage_account_suffix","mode":"managed","type":"random_string","name":"storage_account_suffix","provider_name":"registry.terraform.io/hashicorp/random","schema_version":2,"values":{"keepers":null,"length":8,"lower":true,"min_lower":0,"min_numeric":0,"min_special":0,"min_upper":0,"number":false,"numeric":false,"override_special":null,"special":false,"upper":false},"sensitive_values":{}}]}},"resource_changes":[{"address":"random_string.prefix","mode":"managed","type":"random_string","name":"prefix","provider_name":"registry.terraform.io/hashicorp/random","change":{"actions":["create"],"before":null,"after":{"keepers":null,"length":6,"lower":true,"min_lower":0,"min_numeric":0,"min_special":0,"min_upper":0,"number":false,"numeric":false,"override_special":null,"special":false,"upper":false},"after_unknown":{"id":true,"result":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"random_string.storage_account_suffix","mode":"managed","type":"random_string","name":"storage_account_suffix","provider_name":"registry.terraform.io/hashicorp/random","change":{"actions":["create"],"before":null,"after":{"keepers":null,"length":8,"lower":true,"min_lower":0,"min_numeric":0,"min_special":0,"min_upper":0,"number":false,"numeric":false,"override_special":null,"special":false,"upper":false},"after_unknown":{"id":true,"result":true},"before_sensitive":false,"after_sensitive":{}}}],"configuration":{"provider_config":{"azurerm":{"name":"azurerm","full_name":"registry.terraform.io/hashicorp/azurerm","version_constraint":"3.58.0","expressions":{"features":[{}]}},"random":{"name":"random","full_name":"registry.terraform.io/hashicorp/random"}},"root_module":{"resources":[{"address":"azurerm_federated_identity_credential.federated_identity_credential","mode":"managed","type":"azurerm_federated_identity_credential","name":"federated_identity_credential","provider_config_key":"azurerm","expressions":{"audience":{"constant_value":["api://AzureADTokenExchange"]},"issuer":{"references":["module.aks_cluster.oidc_issuer_url","module.aks_cluster"]},"name":{"references":["var.namespace"]},"parent_id":{"references":["azurerm_user_assigned_identity.aks_workload_identity.id","azurerm_user_assigned_identity.aks_workload_identity"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"subject":{"references":["var.namespace","var.service_account_name"]}},"schema_version":0},{"address":"azurerm_resource_group.rg","mode":"managed","type":"azurerm_resource_group","name":"rg","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.resource_group_name","var.name_prefix","var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_role_assignment.acr_pull_assignment","mode":"managed","type":"azurerm_role_assignment","name":"acr_pull_assignment","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["module.aks_cluster.kubelet_identity_object_id","module.aks_cluster"]},"role_definition_name":{"constant_value":"AcrPull"},"scope":{"references":["module.container_registry.id","module.container_registry"]},"skip_service_principal_aad_check":{"constant_value":true}},"schema_version":0},{"address":"azurerm_role_assignment.cognitive_services_user_assignment","mode":"managed","type":"azurerm_role_assignment","name":"cognitive_services_user_assignment","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_user_assigned_identity.aks_workload_identity.principal_id","azurerm_user_assigned_identity.aks_workload_identity"]},"role_definition_name":{"constant_value":"Cognitive Services User"},"scope":{"references":["module.openai.id","module.openai"]},"skip_service_principal_aad_check":{"constant_value":true}},"schema_version":0},{"address":"azurerm_role_assignment.network_contributor_assignment","mode":"managed","type":"azurerm_role_assignment","name":"network_contributor_assignment","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["module.aks_cluster.aks_identity_principal_id","module.aks_cluster"]},"role_definition_name":{"constant_value":"Network Contributor"},"scope":{"references":["azurerm_resource_group.rg.id","azurerm_resource_group.rg"]},"skip_service_principal_aad_check":{"constant_value":true}},"schema_version":0},{"address":"azurerm_user_assigned_identity.aks_workload_identity","mode":"managed","type":"azurerm_user_assigned_identity","name":"aks_workload_identity","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.workload_managed_identity_name","var.name_prefix","var.workload_managed_identity_name"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"tags":{"references":["var.tags"]}},"schema_version":1},{"address":"random_string.prefix","mode":"managed","type":"random_string","name":"prefix","provider_config_key":"random","expressions":{"length":{"constant_value":6},"numeric":{"constant_value":false},"special":{"constant_value":false},"upper":{"constant_value":false}},"schema_version":2},{"address":"random_string.storage_account_suffix","mode":"managed","type":"random_string","name":"storage_account_suffix","provider_config_key":"random","expressions":{"length":{"constant_value":8},"lower":{"constant_value":true},"numeric":{"constant_value":false},"special":{"constant_value":false},"upper":{"constant_value":false}},"schema_version":2},{"address":"data.azurerm_client_config.current","mode":"data","type":"azurerm_client_config","name":"current","provider_config_key":"azurerm","schema_version":0}],"module_calls":{"acr_private_dns_zone":{"source":"./modules/private_dns_zone","expressions":{"name":{"constant_value":"privatelink.azurecr.io"},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"tags":{"references":["var.tags"]},"virtual_networks_to_link":{"references":["module.virtual_network.name","module.virtual_network","data.azurerm_client_config.current.subscription_id","data.azurerm_client_config.current","azurerm_resource_group.rg.name","azurerm_resource_group.rg"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_private_dns_zone.private_dns_zone.id","azurerm_private_dns_zone.private_dns_zone"]},"description":"Specifies the resource id of the private dns zone"}},"resources":[{"address":"azurerm_private_dns_zone.private_dns_zone","mode":"managed","type":"azurerm_private_dns_zone","name":"private_dns_zone","provider_config_key":"azurerm","expressions":{"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_private_dns_zone_virtual_network_link.link","mode":"managed","type":"azurerm_private_dns_zone_virtual_network_link","name":"link","provider_config_key":"azurerm","expressions":{"name":{"references":["each.key"]},"private_dns_zone_name":{"references":["azurerm_private_dns_zone.private_dns_zone.name","azurerm_private_dns_zone.private_dns_zone"]},"resource_group_name":{"references":["var.resource_group_name"]},"virtual_network_id":{"references":["each.value.subscription_id","each.value","each.value.resource_group_name","each.value","each.key"]}},"schema_version":0,"for_each_expression":{"references":["var.virtual_networks_to_link"]}}],"variables":{"name":{"description":"(Required) Specifies the name of the private dns zone"},"resource_group_name":{"description":"(Required) Specifies the resource group name of the private dns zone"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the private dns zone"},"virtual_networks_to_link":{"default":{},"description":"(Optional) Specifies the subscription id, resource group name, and name of the virtual networks to which create a virtual network link"}}}},"acr_private_endpoint":{"source":"./modules/private_endpoint","expressions":{"is_manual_connection":{"constant_value":false},"location":{"references":["var.location"]},"name":{"references":["module.container_registry.name","module.container_registry"]},"private_connection_resource_id":{"references":["module.container_registry.id","module.container_registry"]},"private_dns_zone_group_ids":{"references":["module.acr_private_dns_zone.id","module.acr_private_dns_zone"]},"private_dns_zone_group_name":{"constant_value":"AcrPrivateDnsZoneGroup"},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"subnet_id":{"references":["module.virtual_network.subnet_ids","module.virtual_network","var.vm_subnet_name"]},"subresource_name":{"constant_value":"registry"},"tags":{"references":["var.tags"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.id","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the resource id of the private endpoint."},"private_dns_zone_configs":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.private_dns_zone_configs","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the private dns zone(s) configuration"},"private_dns_zone_group":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.private_dns_zone_group","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the private dns zone group of the private endpoint."}},"resources":[{"address":"azurerm_private_endpoint.private_endpoint","mode":"managed","type":"azurerm_private_endpoint","name":"private_endpoint","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.name"]},"private_dns_zone_group":[{"name":{"references":["var.private_dns_zone_group_name"]},"private_dns_zone_ids":{"references":["var.private_dns_zone_group_ids"]}}],"private_service_connection":[{"is_manual_connection":{"references":["var.is_manual_connection"]},"name":{"references":["var.name"]},"private_connection_resource_id":{"references":["var.private_connection_resource_id"]},"request_message":{"references":["var.request_message"]},"subresource_names":{"references":["var.subresource_name"]}}],"resource_group_name":{"references":["var.resource_group_name"]},"subnet_id":{"references":["var.subnet_id"]},"tags":{"references":["var.tags"]}},"schema_version":0}],"variables":{"is_manual_connection":{"default":"false","description":"(Optional) Specifies whether the private endpoint connection requires manual approval from the remote resource owner."},"location":{"description":"(Required) Specifies the supported Azure location where the resource exists. Changing this forces a new resource to be created."},"name":{"description":"(Required) Specifies the name of the private endpoint. Changing this forces a new resource to be created."},"private_connection_resource_id":{"description":"(Required) Specifies the resource id of the private link service"},"private_dns":{"default":{}},"private_dns_zone_group_ids":{"description":"(Required) Specifies the list of Private DNS Zones to include within the private_dns_zone_group."},"private_dns_zone_group_name":{"description":"(Required) Specifies the Name of the Private DNS Zone Group. Changing this forces a new private_dns_zone_group resource to be created."},"request_message":{"default":null,"description":"(Optional) Specifies a message passed to the owner of the remote resource when the private endpoint attempts to establish the connection to the remote resource."},"resource_group_name":{"description":"(Required) The name of the resource group. Changing this forces a new resource to be created."},"subnet_id":{"description":"(Required) Specifies the resource id of the subnet"},"subresource_name":{"default":null,"description":"(Optional) Specifies a subresource name which the Private Endpoint is able to connect to."},"tags":{"default":{},"description":"(Optional) Specifies the tags of the network security group"}}}},"aks_cluster":{"source":"./modules/aks","expressions":{"admin_group_object_ids":{"references":["var.admin_group_object_ids"]},"admin_username":{"references":["var.admin_username"]},"automatic_channel_upgrade":{"references":["var.automatic_channel_upgrade"]},"azure_policy_enabled":{"references":["var.azure_policy_enabled"]},"azure_rbac_enabled":{"references":["var.azure_rbac_enabled"]},"dns_prefix":{"references":["var.aks_cluster_name"]},"http_application_routing_enabled":{"references":["var.http_application_routing_enabled"]},"image_cleaner_enabled":{"references":["var.image_cleaner_enabled"]},"keda_enabled":{"references":["var.keda_enabled"]},"kubernetes_version":{"references":["var.kubernetes_version"]},"location":{"references":["var.location"]},"log_analytics_workspace_id":{"references":["module.log_analytics_workspace.id","module.log_analytics_workspace"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.aks_cluster_name","var.name_prefix","var.aks_cluster_name"]},"network_dns_service_ip":{"references":["var.network_dns_service_ip"]},"network_plugin":{"references":["var.network_plugin"]},"network_service_cidr":{"references":["var.network_service_cidr"]},"oidc_issuer_enabled":{"references":["var.oidc_issuer_enabled"]},"open_service_mesh_enabled":{"references":["var.open_service_mesh_enabled"]},"outbound_type":{"constant_value":"userAssignedNATGateway"},"pod_subnet_id":{"references":["module.virtual_network.subnet_ids","module.virtual_network","var.pod_subnet_name"]},"private_cluster_enabled":{"references":["var.private_cluster_enabled"]},"resource_group_id":{"references":["azurerm_resource_group.rg.id","azurerm_resource_group.rg"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"role_based_access_control_enabled":{"references":["var.role_based_access_control_enabled"]},"sku_tier":{"references":["var.sku_tier"]},"ssh_public_key":{"references":["var.ssh_public_key"]},"system_node_pool_availability_zones":{"references":["var.system_node_pool_availability_zones"]},"system_node_pool_enable_auto_scaling":{"references":["var.system_node_pool_enable_auto_scaling"]},"system_node_pool_enable_host_encryption":{"references":["var.system_node_pool_enable_host_encryption"]},"system_node_pool_enable_node_public_ip":{"references":["var.system_node_pool_enable_node_public_ip"]},"system_node_pool_max_count":{"references":["var.system_node_pool_max_count"]},"system_node_pool_max_pods":{"references":["var.system_node_pool_max_pods"]},"system_node_pool_min_count":{"references":["var.system_node_pool_min_count"]},"system_node_pool_name":{"references":["var.system_node_pool_name"]},"system_node_pool_node_count":{"references":["var.system_node_pool_node_count"]},"system_node_pool_node_labels":{"references":["var.system_node_pool_node_labels"]},"system_node_pool_node_taints":{"references":["var.system_node_pool_node_taints"]},"system_node_pool_os_disk_type":{"references":["var.system_node_pool_os_disk_type"]},"system_node_pool_vm_size":{"references":["var.system_node_pool_vm_size"]},"tags":{"references":["var.tags"]},"tenant_id":{"references":["data.azurerm_client_config.current.tenant_id","data.azurerm_client_config.current"]},"vertical_pod_autoscaler_enabled":{"references":["var.vertical_pod_autoscaler_enabled"]},"vnet_subnet_id":{"references":["module.virtual_network.subnet_ids","module.virtual_network","var.system_node_pool_subnet_name"]},"workload_identity_enabled":{"references":["var.workload_identity_enabled"]}},"module":{"outputs":{"aks_identity_principal_id":{"expression":{"references":["azurerm_user_assigned_identity.aks_identity.principal_id","azurerm_user_assigned_identity.aks_identity"]},"description":"Specifies the principal id of the managed identity of the AKS cluster."},"id":{"expression":{"references":["azurerm_kubernetes_cluster.aks_cluster.id","azurerm_kubernetes_cluster.aks_cluster"]},"description":"Specifies the resource id of the AKS cluster."},"kube_config_raw":{"expression":{"references":["azurerm_kubernetes_cluster.aks_cluster.kube_config_raw","azurerm_kubernetes_cluster.aks_cluster"]},"description":"Contains the Kubernetes config to be used by kubectl and other compatible tools."},"kubelet_identity_object_id":{"expression":{"references":["azurerm_kubernetes_cluster.aks_cluster.kubelet_identity[0].object_id","azurerm_kubernetes_cluster.aks_cluster.kubelet_identity[0]","azurerm_kubernetes_cluster.aks_cluster.kubelet_identity","azurerm_kubernetes_cluster.aks_cluster"]},"description":"Specifies the object id of the kubelet identity of the AKS cluster."},"name":{"expression":{"references":["azurerm_kubernetes_cluster.aks_cluster.name","azurerm_kubernetes_cluster.aks_cluster"]},"description":"Specifies the name of the AKS cluster."},"node_resource_group":{"expression":{"references":["azurerm_kubernetes_cluster.aks_cluster.node_resource_group","azurerm_kubernetes_cluster.aks_cluster"]},"description":"Specifies the resource id of the auto-generated Resource Group which contains the resources for this Managed Kubernetes Cluster."},"oidc_issuer_url":{"expression":{"references":["azurerm_kubernetes_cluster.aks_cluster.oidc_issuer_url","azurerm_kubernetes_cluster.aks_cluster"]},"description":"Specifies the URL of the OpenID Connect issuer used by this Kubernetes Cluster."},"private_fqdn":{"expression":{"references":["azurerm_kubernetes_cluster.aks_cluster.private_fqdn","azurerm_kubernetes_cluster.aks_cluster"]},"description":"The FQDN for the Kubernetes Cluster when private link has been enabled, which is only resolvable inside the Virtual Network used by the Kubernetes Cluster."}},"resources":[{"address":"azurerm_kubernetes_cluster.aks_cluster","mode":"managed","type":"azurerm_kubernetes_cluster","name":"aks_cluster","provider_config_key":"azurerm","expressions":{"automatic_channel_upgrade":{"references":["var.automatic_channel_upgrade"]},"azure_active_directory_role_based_access_control":[{"admin_group_object_ids":{"references":["var.admin_group_object_ids"]},"azure_rbac_enabled":{"references":["var.azure_rbac_enabled"]},"managed":{"constant_value":true},"tenant_id":{"references":["var.tenant_id"]}}],"azure_policy_enabled":{"references":["var.azure_policy_enabled"]},"default_node_pool":[{"enable_auto_scaling":{"references":["var.system_node_pool_enable_auto_scaling"]},"enable_host_encryption":{"references":["var.system_node_pool_enable_host_encryption"]},"enable_node_public_ip":{"references":["var.system_node_pool_enable_node_public_ip"]},"max_count":{"references":["var.system_node_pool_max_count"]},"max_pods":{"references":["var.system_node_pool_max_pods"]},"min_count":{"references":["var.system_node_pool_min_count"]},"name":{"references":["var.system_node_pool_name"]},"node_count":{"references":["var.system_node_pool_node_count"]},"node_labels":{"references":["var.system_node_pool_node_labels"]},"node_taints":{"references":["var.system_node_pool_node_taints"]},"os_disk_type":{"references":["var.system_node_pool_os_disk_type"]},"pod_subnet_id":{"references":["var.pod_subnet_id"]},"tags":{"references":["var.tags"]},"vm_size":{"references":["var.system_node_pool_vm_size"]},"vnet_subnet_id":{"references":["var.vnet_subnet_id"]},"zones":{"references":["var.system_node_pool_availability_zones"]}}],"dns_prefix":{"references":["var.dns_prefix"]},"http_application_routing_enabled":{"references":["var.http_application_routing_enabled"]},"identity":[{"identity_ids":{"references":["azurerm_user_assigned_identity.aks_identity.id","azurerm_user_assigned_identity.aks_identity"]},"type":{"constant_value":"UserAssigned"}}],"image_cleaner_enabled":{"references":["var.image_cleaner_enabled"]},"kubernetes_version":{"references":["var.kubernetes_version"]},"linux_profile":[{"admin_username":{"references":["var.admin_username"]},"ssh_key":[{"key_data":{"references":["var.ssh_public_key"]}}]}],"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_profile":[{"dns_service_ip":{"references":["var.network_dns_service_ip"]},"network_plugin":{"references":["var.network_plugin"]},"outbound_type":{"references":["var.outbound_type"]},"service_cidr":{"references":["var.network_service_cidr"]}}],"oidc_issuer_enabled":{"references":["var.oidc_issuer_enabled"]},"oms_agent":[{"log_analytics_workspace_id":{"references":["var.oms_agent.log_analytics_workspace_id","var.oms_agent","var.log_analytics_workspace_id"]},"msi_auth_for_monitoring_enabled":{"constant_value":true}}],"open_service_mesh_enabled":{"references":["var.open_service_mesh_enabled"]},"private_cluster_enabled":{"references":["var.private_cluster_enabled"]},"resource_group_name":{"references":["var.resource_group_name"]},"sku_tier":{"references":["var.sku_tier"]},"workload_autoscaler_profile":[{"keda_enabled":{"references":["var.keda_enabled"]},"vertical_pod_autoscaler_enabled":{"references":["var.vertical_pod_autoscaler_enabled"]}}],"workload_identity_enabled":{"references":["var.workload_identity_enabled"]}},"schema_version":2},{"address":"azurerm_monitor_diagnostic_setting.settings","mode":"managed","type":"azurerm_monitor_diagnostic_setting","name":"settings","provider_config_key":"azurerm","expressions":{"enabled_log":[{"category":{"constant_value":"kube-apiserver"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"kube-audit"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"kube-audit-admin"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"kube-controller-manager"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"kube-scheduler"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"cluster-autoscaler"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"guard"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"log_analytics_workspace_id":{"references":["var.log_analytics_workspace_id"]},"metric":[{"category":{"constant_value":"AllMetrics"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"name":{"constant_value":"DiagnosticsSettings"},"target_resource_id":{"references":["azurerm_kubernetes_cluster.aks_cluster.id","azurerm_kubernetes_cluster.aks_cluster"]}},"schema_version":0},{"address":"azurerm_user_assigned_identity.aks_identity","mode":"managed","type":"azurerm_user_assigned_identity","name":"aks_identity","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":1}],"variables":{"admin_group_object_ids":{"default":[],"description":"(Optional) A list of Object IDs of Azure Active Directory Groups which should have Admin Role on the Cluster."},"admin_username":{"default":"azadmin","description":"(Required) Specifies the Admin Username for the AKS cluster worker nodes. Changing this forces a new resource to be created."},"automatic_channel_upgrade":{"default":"stable","description":"(Optional) The upgrade channel for this Kubernetes Cluster. Possible values are patch, rapid, and stable."},"azure_policy_enabled":{"default":true,"description":"(Optional) Should the Azure Policy Add-On be enabled? For more details please visit Understand Azure Policy for Azure Kubernetes Service"},"azure_rbac_enabled":{"default":true,"description":"(Optional) Is Role Based Access Control based on Azure AD enabled?"},"dns_prefix":{"description":"(Optional) DNS prefix specified when creating the managed cluster. Changing this forces a new resource to be created."},"http_application_routing_enabled":{"default":false,"description":"(Optional) Should HTTP Application Routing be enabled?"},"image_cleaner_enabled":{"default":true,"description":"(Optional) Specifies whether Image Cleaner is enabled."},"ingress_application_gateway":{"default":{"enabled":false,"gateway_id":null,"gateway_name":null,"subnet_cidr":null,"subnet_id":null},"description":"Specifies the Application Gateway Ingress Controller addon configuration."},"keda_enabled":{"default":true,"description":"(Optional) Specifies whether KEDA Autoscaler can be used for workloads."},"kubernetes_version":{"default":"1.21.1","description":"Specifies the AKS Kubernetes version"},"location":{"description":"(Required) Specifies the location where the AKS cluster will be deployed."},"log_analytics_retention_days":{"default":30,"description":"Specifies the number of days of the retention policy"},"log_analytics_workspace_id":{"description":"(Optional) The ID of the Log Analytics Workspace which the OMS Agent should send data to. Must be present if enabled is true."},"name":{"description":"(Required) Specifies the name of the AKS cluster."},"network_dns_service_ip":{"default":"10.2.0.10","description":"Specifies the DNS service IP"},"network_plugin":{"default":"azure","description":"Specifies the network plugin of the AKS cluster"},"network_service_cidr":{"default":"10.2.0.0/24","description":"Specifies the service CIDR"},"oidc_issuer_enabled":{"default":true,"description":"(Optional) Enable or Disable the OIDC issuer URL."},"oms_agent":{"default":{"enabled":true,"log_analytics_workspace_id":null},"description":"Specifies the OMS agent addon configuration."},"open_service_mesh_enabled":{"default":true,"description":"(Optional) Is Open Service Mesh enabled? For more details, please visit Open Service Mesh for AKS."},"outbound_type":{"default":"userDefinedRouting","description":"(Optional) The outbound (egress) routing method which should be used for this Kubernetes Cluster. Possible values are loadBalancer and userDefinedRouting. Defaults to loadBalancer."},"pod_subnet_id":{"default":null,"description":"(Optional) The ID of the Subnet where the pods in the system node pool should exist. Changing this forces a new resource to be created."},"private_cluster_enabled":{"default":false,"description":"Should this Kubernetes Cluster have its API server only exposed on internal IP addresses? This provides a Private IP Address for the Kubernetes API on the Virtual Network where the Kubernetes Cluster is located. Defaults to false. Changing this forces a new resource to be created."},"resource_group_id":{"description":"(Required) Specifies the resource id of the resource group."},"resource_group_name":{"description":"(Required) Specifies the name of the resource group."},"role_based_access_control_enabled":{"default":true,"description":"(Required) Is Role Based Access Control Enabled? Changing this forces a new resource to be created."},"sku_tier":{"default":"Free","description":"(Optional) The SKU Tier that should be used for this Kubernetes Cluster. Possible values are Free and Paid (which includes the Uptime SLA). Defaults to Free."},"ssh_public_key":{"description":"(Required) Specifies the SSH public key used to access the cluster. Changing this forces a new resource to be created."},"system_node_pool_availability_zones":{"default":["1","2","3"],"description":"Specifies the availability zones of the system node pool"},"system_node_pool_enable_auto_scaling":{"default":true,"description":"(Optional) Whether to enable auto-scaler. Defaults to false."},"system_node_pool_enable_host_encryption":{"default":false,"description":"(Optional) Should the nodes in this Node Pool have host encryption enabled? Defaults to false."},"system_node_pool_enable_node_public_ip":{"default":false,"description":"(Optional) Should each node have a Public IP Address? Defaults to false. Changing this forces a new resource to be created."},"system_node_pool_max_count":{"default":10,"description":"(Required) The maximum number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be greater than or equal to min_count."},"system_node_pool_max_pods":{"default":50,"description":"(Optional) The maximum number of pods that can run on each agent. Changing this forces a new resource to be created."},"system_node_pool_min_count":{"default":3,"description":"(Required) The minimum number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be less than or equal to max_count."},"system_node_pool_name":{"default":"system","description":"Specifies the name of the system node pool"},"system_node_pool_node_count":{"default":3,"description":"(Optional) The initial number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be a value in the range min_count - max_count."},"system_node_pool_node_labels":{"default":{},"description":"(Optional) A list of Kubernetes taints which should be applied to nodes in the agent pool (e.g key=value:NoSchedule). Changing this forces a new resource to be created."},"system_node_pool_node_taints":{"default":[],"description":"(Optional) A map of Kubernetes labels which should be applied to nodes in this Node Pool. Changing this forces a new resource to be created."},"system_node_pool_os_disk_type":{"default":"Ephemeral","description":"(Optional) The type of disk which should be used for the Operating System. Possible values are Ephemeral and Managed. Defaults to Managed. Changing this forces a new resource to be created."},"system_node_pool_subnet_address_prefix":{"default":["10.0.0.0/20"],"description":"Specifies the address prefix of the subnet that hosts the system node pool"},"system_node_pool_subnet_name":{"default":"SystemSubnet","description":"Specifies the name of the subnet that hosts the system node pool"},"system_node_pool_vm_size":{"default":"Standard_F8s_v2","description":"Specifies the vm size of the system node pool"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the bastion host"},"tenant_id":{"description":"(Required) The tenant id of the system assigned identity which is used by master components."},"vertical_pod_autoscaler_enabled":{"default":true,"description":"(Optional) Specifies whether Vertical Pod Autoscaler should be enabled."},"vnet_subnet_id":{"description":"(Optional) The ID of a Subnet where the Kubernetes Node Pool should exist. Changing this forces a new resource to be created."},"workload_identity_enabled":{"default":true,"description":"(Optional) Specifies whether Azure AD Workload Identity should be enabled for the Cluster. Defaults to false."}}},"depends_on":["module.nat_gateway","module.container_registry"]},"bastion_host":{"source":"./modules/bastion_host","expressions":{"location":{"references":["var.location"]},"log_analytics_retention_days":{"references":["var.log_analytics_retention_days"]},"log_analytics_workspace_id":{"references":["module.log_analytics_workspace.id","module.log_analytics_workspace"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.bastion_host_name","var.name_prefix","var.bastion_host_name"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"subnet_id":{"references":["module.virtual_network.subnet_ids[\"AzureBastionSubnet\"]","module.virtual_network.subnet_ids","module.virtual_network"]},"tags":{"references":["var.tags"]}},"module":{"outputs":{"bastion_host":{"expression":{"references":["azurerm_bastion_host.bastion_host"]},"depends_on":["azurerm_bastion_host.bastion_host"],"description":"Contains the bastion host resource"},"id":{"expression":{"references":["azurerm_bastion_host.bastion_host"]},"depends_on":["azurerm_bastion_host.bastion_host"],"description":"Specifies the resource id of the bastion host"},"name":{"expression":{"references":["azurerm_bastion_host.bastion_host"]},"depends_on":["azurerm_bastion_host.bastion_host"],"description":"Specifies the name of the bastion host"},"public_ip_address":{"expression":{"references":["azurerm_public_ip.public_ip.ip_address","azurerm_public_ip.public_ip"]},"depends_on":["azurerm_bastion_host.bastion_host"],"description":"Contains the public IP address of the bastion host."}},"resources":[{"address":"azurerm_bastion_host.bastion_host","mode":"managed","type":"azurerm_bastion_host","name":"bastion_host","provider_config_key":"azurerm","expressions":{"ip_configuration":[{"name":{"constant_value":"configuration"},"public_ip_address_id":{"references":["azurerm_public_ip.public_ip.id","azurerm_public_ip.public_ip"]},"subnet_id":{"references":["var.subnet_id"]}}],"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_monitor_diagnostic_setting.pip_settings","mode":"managed","type":"azurerm_monitor_diagnostic_setting","name":"pip_settings","provider_config_key":"azurerm","expressions":{"enabled_log":[{"category":{"constant_value":"DDoSProtectionNotifications"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"DDoSMitigationFlowLogs"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"DDoSMitigationReports"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"log_analytics_workspace_id":{"references":["var.log_analytics_workspace_id"]},"metric":[{"category":{"constant_value":"AllMetrics"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"name":{"constant_value":"DiagnosticsSettings"},"target_resource_id":{"references":["azurerm_public_ip.public_ip.id","azurerm_public_ip.public_ip"]}},"schema_version":0},{"address":"azurerm_monitor_diagnostic_setting.settings","mode":"managed","type":"azurerm_monitor_diagnostic_setting","name":"settings","provider_config_key":"azurerm","expressions":{"enabled_log":[{"category":{"constant_value":"BastionAuditLogs"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"log_analytics_workspace_id":{"references":["var.log_analytics_workspace_id"]},"metric":[{"category":{"constant_value":"AllMetrics"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"name":{"constant_value":"DiagnosticsSettings"},"target_resource_id":{"references":["azurerm_bastion_host.bastion_host.id","azurerm_bastion_host.bastion_host"]}},"schema_version":0},{"address":"azurerm_public_ip.public_ip","mode":"managed","type":"azurerm_public_ip","name":"public_ip","provider_config_key":"azurerm","expressions":{"allocation_method":{"constant_value":"Static"},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"sku":{"constant_value":"Standard"},"tags":{"references":["var.tags"]}},"schema_version":0}],"variables":{"location":{"description":"(Required) Specifies the location of the bastion host"},"log_analytics_retention_days":{"default":7,"description":"Specifies the number of days of the retention policy"},"log_analytics_workspace_id":{"description":"Specifies the log analytics workspace id"},"name":{"description":"(Required) Specifies the name of the bastion host"},"resource_group_name":{"description":"(Required) Specifies the resource group name of the bastion host"},"subnet_id":{"description":"(Required) Specifies subnet id of the bastion host"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the bastion host"}}}},"blob_private_dns_zone":{"source":"./modules/private_dns_zone","expressions":{"name":{"constant_value":"privatelink.blob.core.windows.net"},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"tags":{"references":["var.tags"]},"virtual_networks_to_link":{"references":["module.virtual_network.name","module.virtual_network","data.azurerm_client_config.current.subscription_id","data.azurerm_client_config.current","azurerm_resource_group.rg.name","azurerm_resource_group.rg"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_private_dns_zone.private_dns_zone.id","azurerm_private_dns_zone.private_dns_zone"]},"description":"Specifies the resource id of the private dns zone"}},"resources":[{"address":"azurerm_private_dns_zone.private_dns_zone","mode":"managed","type":"azurerm_private_dns_zone","name":"private_dns_zone","provider_config_key":"azurerm","expressions":{"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_private_dns_zone_virtual_network_link.link","mode":"managed","type":"azurerm_private_dns_zone_virtual_network_link","name":"link","provider_config_key":"azurerm","expressions":{"name":{"references":["each.key"]},"private_dns_zone_name":{"references":["azurerm_private_dns_zone.private_dns_zone.name","azurerm_private_dns_zone.private_dns_zone"]},"resource_group_name":{"references":["var.resource_group_name"]},"virtual_network_id":{"references":["each.value.subscription_id","each.value","each.value.resource_group_name","each.value","each.key"]}},"schema_version":0,"for_each_expression":{"references":["var.virtual_networks_to_link"]}}],"variables":{"name":{"description":"(Required) Specifies the name of the private dns zone"},"resource_group_name":{"description":"(Required) Specifies the resource group name of the private dns zone"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the private dns zone"},"virtual_networks_to_link":{"default":{},"description":"(Optional) Specifies the subscription id, resource group name, and name of the virtual networks to which create a virtual network link"}}}},"blob_private_endpoint":{"source":"./modules/private_endpoint","expressions":{"is_manual_connection":{"constant_value":false},"location":{"references":["var.location"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.name_prefix"]},"private_connection_resource_id":{"references":["module.storage_account.id","module.storage_account"]},"private_dns_zone_group_ids":{"references":["module.blob_private_dns_zone.id","module.blob_private_dns_zone"]},"private_dns_zone_group_name":{"constant_value":"BlobPrivateDnsZoneGroup"},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"subnet_id":{"references":["module.virtual_network.subnet_ids","module.virtual_network","var.vm_subnet_name"]},"subresource_name":{"constant_value":"blob"},"tags":{"references":["var.tags"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.id","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the resource id of the private endpoint."},"private_dns_zone_configs":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.private_dns_zone_configs","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the private dns zone(s) configuration"},"private_dns_zone_group":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.private_dns_zone_group","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the private dns zone group of the private endpoint."}},"resources":[{"address":"azurerm_private_endpoint.private_endpoint","mode":"managed","type":"azurerm_private_endpoint","name":"private_endpoint","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.name"]},"private_dns_zone_group":[{"name":{"references":["var.private_dns_zone_group_name"]},"private_dns_zone_ids":{"references":["var.private_dns_zone_group_ids"]}}],"private_service_connection":[{"is_manual_connection":{"references":["var.is_manual_connection"]},"name":{"references":["var.name"]},"private_connection_resource_id":{"references":["var.private_connection_resource_id"]},"request_message":{"references":["var.request_message"]},"subresource_names":{"references":["var.subresource_name"]}}],"resource_group_name":{"references":["var.resource_group_name"]},"subnet_id":{"references":["var.subnet_id"]},"tags":{"references":["var.tags"]}},"schema_version":0}],"variables":{"is_manual_connection":{"default":"false","description":"(Optional) Specifies whether the private endpoint connection requires manual approval from the remote resource owner."},"location":{"description":"(Required) Specifies the supported Azure location where the resource exists. Changing this forces a new resource to be created."},"name":{"description":"(Required) Specifies the name of the private endpoint. Changing this forces a new resource to be created."},"private_connection_resource_id":{"description":"(Required) Specifies the resource id of the private link service"},"private_dns":{"default":{}},"private_dns_zone_group_ids":{"description":"(Required) Specifies the list of Private DNS Zones to include within the private_dns_zone_group."},"private_dns_zone_group_name":{"description":"(Required) Specifies the Name of the Private DNS Zone Group. Changing this forces a new private_dns_zone_group resource to be created."},"request_message":{"default":null,"description":"(Optional) Specifies a message passed to the owner of the remote resource when the private endpoint attempts to establish the connection to the remote resource."},"resource_group_name":{"description":"(Required) The name of the resource group. Changing this forces a new resource to be created."},"subnet_id":{"description":"(Required) Specifies the resource id of the subnet"},"subresource_name":{"default":null,"description":"(Optional) Specifies a subresource name which the Private Endpoint is able to connect to."},"tags":{"default":{},"description":"(Optional) Specifies the tags of the network security group"}}}},"container_registry":{"source":"./modules/container_registry","expressions":{"admin_enabled":{"references":["var.acr_admin_enabled"]},"georeplication_locations":{"references":["var.acr_georeplication_locations"]},"location":{"references":["var.location"]},"log_analytics_retention_days":{"references":["var.log_analytics_retention_days"]},"log_analytics_workspace_id":{"references":["module.log_analytics_workspace.id","module.log_analytics_workspace"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.acr_name","var.name_prefix","var.acr_name"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"sku":{"references":["var.acr_sku"]},"tags":{"references":["var.tags"]}},"module":{"outputs":{"admin_username":{"expression":{"references":["azurerm_container_registry.acr.admin_username","azurerm_container_registry.acr"]},"description":"Specifies the admin username of the container registry."},"id":{"expression":{"references":["azurerm_container_registry.acr.id","azurerm_container_registry.acr"]},"description":"Specifies the resource id of the container registry."},"login_server":{"expression":{"references":["azurerm_container_registry.acr.login_server","azurerm_container_registry.acr"]},"description":"Specifies the login server of the container registry."},"login_server_url":{"expression":{"references":["azurerm_container_registry.acr.login_server","azurerm_container_registry.acr"]},"description":"Specifies the login server url of the container registry."},"name":{"expression":{"references":["azurerm_container_registry.acr.name","azurerm_container_registry.acr"]},"description":"Specifies the name of the container registry."},"resource_group_name":{"expression":{"references":["var.resource_group_name"]},"description":"Specifies the name of the resource group."}},"resources":[{"address":"azurerm_container_registry.acr","mode":"managed","type":"azurerm_container_registry","name":"acr","provider_config_key":"azurerm","expressions":{"admin_enabled":{"references":["var.admin_enabled"]},"identity":[{"identity_ids":{"references":["azurerm_user_assigned_identity.acr_identity.id","azurerm_user_assigned_identity.acr_identity"]},"type":{"constant_value":"UserAssigned"}}],"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"sku":{"references":["var.sku"]},"tags":{"references":["var.tags"]}},"schema_version":2},{"address":"azurerm_monitor_diagnostic_setting.settings","mode":"managed","type":"azurerm_monitor_diagnostic_setting","name":"settings","provider_config_key":"azurerm","expressions":{"enabled_log":[{"category":{"constant_value":"ContainerRegistryRepositoryEvents"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"ContainerRegistryLoginEvents"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"log_analytics_workspace_id":{"references":["var.log_analytics_workspace_id"]},"metric":[{"category":{"constant_value":"AllMetrics"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"name":{"constant_value":"DiagnosticsSettings"},"target_resource_id":{"references":["azurerm_container_registry.acr.id","azurerm_container_registry.acr"]}},"schema_version":0},{"address":"azurerm_user_assigned_identity.acr_identity","mode":"managed","type":"azurerm_user_assigned_identity","name":"acr_identity","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":1}],"variables":{"admin_enabled":{"default":"false","description":"(Optional) Specifies whether the admin user is enabled. Defaults to false."},"georeplication_locations":{"default":[],"description":"(Optional) A list of Azure locations where the container registry should be geo-replicated."},"location":{"description":"(Required) Specifies the supported Azure location where the resource exists. Changing this forces a new resource to be created."},"log_analytics_retention_days":{"default":7,"description":"Specifies the number of days of the retention policy"},"log_analytics_workspace_id":{"description":"Specifies the log analytics workspace id"},"name":{"description":"(Required) Specifies the name of the Container Registry. Changing this forces a new resource to be created."},"resource_group_name":{"description":"(Required) The name of the resource group in which to create the Container Registry. Changing this forces a new resource to be created."},"sku":{"default":"Basic","description":"(Optional) The SKU name of the container registry. Possible values are Basic, Standard and Premium. Defaults to Basic"},"tags":{"default":{},"description":"(Optional) A mapping of tags to assign to the resource."}}}},"deployment_script":{"source":"./modules/deployment_script","expressions":{"aks_cluster_name":{"references":["module.aks_cluster.name","module.aks_cluster"]},"azure_cli_version":{"references":["var.deployment_script_azure_cli_version"]},"email":{"references":["var.email"]},"hostname":{"references":["var.subdomain","var.domain"]},"location":{"references":["var.location"]},"managed_identity_name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.deployment_script_managed_identity_name","var.name_prefix","var.deployment_script_managed_identity_name"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.deployment_script_name","var.name_prefix","var.deployment_script_name"]},"namespace":{"references":["var.namespace"]},"primary_script_uri":{"references":["var.deployment_script_primary_script_uri"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"service_account_name":{"references":["var.service_account_name"]},"subscription_id":{"references":["data.azurerm_client_config.current.subscription_id","data.azurerm_client_config.current"]},"tags":{"references":["var.tags"]},"tenant_id":{"references":["data.azurerm_client_config.current.tenant_id","data.azurerm_client_config.current"]},"workload_managed_identity_client_id":{"references":["azurerm_user_assigned_identity.aks_workload_identity.client_id","azurerm_user_assigned_identity.aks_workload_identity"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_resource_deployment_script_azure_cli.script.id","azurerm_resource_deployment_script_azure_cli.script"]},"description":"Specifies the resource id of the deployment script"},"outputs":{"expression":{"references":["azurerm_resource_deployment_script_azure_cli.script.outputs","azurerm_resource_deployment_script_azure_cli.script"]},"description":"Specifies the list of script outputs."}},"resources":[{"address":"azurerm_resource_deployment_script_azure_cli.script","mode":"managed","type":"azurerm_resource_deployment_script_azure_cli","name":"script","provider_config_key":"azurerm","expressions":{"cleanup_preference":{"constant_value":"OnSuccess"},"command_line":{"constant_value":"'foo' 'bar'"},"environment_variable":[{"name":{"constant_value":"clusterName"},"value":{"references":["var.aks_cluster_name"]}},{"name":{"constant_value":"resourceGroupName"},"value":{"references":["var.resource_group_name"]}},{"name":{"constant_value":"applicationGatewayEnabled"},"value":{"constant_value":false}},{"name":{"constant_value":"tenantId"},"value":{"references":["var.tenant_id"]}},{"name":{"constant_value":"subscriptionId"},"value":{"references":["var.subscription_id"]}},{"name":{"constant_value":"hostName"},"value":{"references":["var.hostname"]}},{"name":{"constant_value":"namespace"},"value":{"references":["var.namespace"]}},{"name":{"constant_value":"serviceAccountName"},"value":{"references":["var.service_account_name"]}},{"name":{"constant_value":"workloadManagedIdentityClientId"},"value":{"references":["var.workload_managed_identity_client_id"]}},{"name":{"constant_value":"email"},"value":{"references":["var.email"]}}],"force_update_tag":{"constant_value":"1"},"identity":[{"identity_ids":{"references":["azurerm_user_assigned_identity.script_identity.id","azurerm_user_assigned_identity.script_identity"]},"type":{"constant_value":"UserAssigned"}}],"location":{"references":["var.location"]},"name":{"references":["var.name"]},"primary_script_uri":{"references":["var.primary_script_uri"]},"resource_group_name":{"references":["var.resource_group_name"]},"retention_interval":{"constant_value":"P1D"},"tags":{"references":["var.tags"]},"timeout":{"constant_value":"PT30M"},"version":{"references":["var.azure_cli_version"]}},"schema_version":0},{"address":"azurerm_role_assignment.network_contributor_assignment","mode":"managed","type":"azurerm_role_assignment","name":"network_contributor_assignment","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_user_assigned_identity.script_identity.principal_id","azurerm_user_assigned_identity.script_identity"]},"role_definition_name":{"constant_value":"Azure Kubernetes Service Cluster Admin Role"},"scope":{"references":["data.azurerm_kubernetes_cluster.aks_cluster.id","data.azurerm_kubernetes_cluster.aks_cluster"]},"skip_service_principal_aad_check":{"constant_value":true}},"schema_version":0},{"address":"azurerm_user_assigned_identity.script_identity","mode":"managed","type":"azurerm_user_assigned_identity","name":"script_identity","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.managed_identity_name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":1},{"address":"data.azurerm_kubernetes_cluster.aks_cluster","mode":"data","type":"azurerm_kubernetes_cluster","name":"aks_cluster","provider_config_key":"azurerm","expressions":{"name":{"references":["var.aks_cluster_name"]},"resource_group_name":{"references":["var.resource_group_name"]}},"schema_version":0}],"variables":{"aks_cluster_name":{"description":"Specifies the name of the AKS cluster."},"azure_cli_version":{"default":"2.9.1","description":"(Required) Azure CLI module version to be used."},"email":{"description":"Specifies the email address for the cert-manager cluster issuer."},"hostname":{"description":"Specifies the hostname of the application."},"location":{"description":"(Required) Specifies the location of the Azure OpenAI Service"},"managed_identity_name":{"default":"ScriptManagedIdentity","description":"Specifies the name of the user-defined managed identity used by the deployment script."},"name":{"default":"BashScript","description":"(Required) Specifies the name of the Azure OpenAI Service"},"namespace":{"description":"Specifies the namespace of the application."},"primary_script_uri":{"description":"(Optional) Uri for the script. This is the entry point for the external script. Changing this forces a new Resource Deployment Script to be created."},"resource_group_name":{"description":"(Required) Specifies the resource group name"},"service_account_name":{"description":"Specifies the service account of the application."},"subscription_id":{"description":"Specifies the Azure subscription id."},"tags":{"default":{},"description":"(Optional) Specifies the tags of the Azure OpenAI Service"},"tenant_id":{"description":"Specifies the Azure AD tenant id."},"workload_managed_identity_client_id":{"description":"Specifies the client id of the workload user-defined managed identity."}}},"depends_on":["module.aks_cluster"]},"key_vault":{"source":"./modules/key_vault","expressions":{"bypass":{"references":["var.key_vault_bypass"]},"default_action":{"references":["var.key_vault_default_action"]},"enable_rbac_authorization":{"references":["var.key_vault_enable_rbac_authorization"]},"enabled_for_deployment":{"references":["var.key_vault_enabled_for_deployment"]},"enabled_for_disk_encryption":{"references":["var.key_vault_enabled_for_disk_encryption"]},"enabled_for_template_deployment":{"references":["var.key_vault_enabled_for_template_deployment"]},"location":{"references":["var.location"]},"log_analytics_retention_days":{"references":["var.log_analytics_retention_days"]},"log_analytics_workspace_id":{"references":["module.log_analytics_workspace.id","module.log_analytics_workspace"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.key_vault_name","var.name_prefix","var.key_vault_name"]},"purge_protection_enabled":{"references":["var.key_vault_purge_protection_enabled"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"sku_name":{"references":["var.key_vault_sku_name"]},"soft_delete_retention_days":{"references":["var.key_vault_soft_delete_retention_days"]},"tags":{"references":["var.tags"]},"tenant_id":{"references":["data.azurerm_client_config.current.tenant_id","data.azurerm_client_config.current"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_key_vault.key_vault.id","azurerm_key_vault.key_vault"]},"description":"Specifies the resource id of the key vault."},"name":{"expression":{"references":["azurerm_key_vault.key_vault.name","azurerm_key_vault.key_vault"]},"description":"Specifies the name of the key vault."}},"resources":[{"address":"azurerm_key_vault.key_vault","mode":"managed","type":"azurerm_key_vault","name":"key_vault","provider_config_key":"azurerm","expressions":{"enable_rbac_authorization":{"references":["var.enable_rbac_authorization"]},"enabled_for_deployment":{"references":["var.enabled_for_deployment"]},"enabled_for_disk_encryption":{"references":["var.enabled_for_disk_encryption"]},"enabled_for_template_deployment":{"references":["var.enabled_for_template_deployment"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_acls":[{"bypass":{"references":["var.bypass"]},"default_action":{"references":["var.default_action"]},"ip_rules":{"references":["var.ip_rules"]},"virtual_network_subnet_ids":{"references":["var.virtual_network_subnet_ids"]}}],"purge_protection_enabled":{"references":["var.purge_protection_enabled"]},"resource_group_name":{"references":["var.resource_group_name"]},"sku_name":{"references":["var.sku_name"]},"soft_delete_retention_days":{"references":["var.soft_delete_retention_days"]},"tags":{"references":["var.tags"]},"tenant_id":{"references":["var.tenant_id"]},"timeouts":{"delete":{"constant_value":"60m"}}},"schema_version":2},{"address":"azurerm_monitor_diagnostic_setting.settings","mode":"managed","type":"azurerm_monitor_diagnostic_setting","name":"settings","provider_config_key":"azurerm","expressions":{"enabled_log":[{"category":{"constant_value":"AuditEvent"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"AzurePolicyEvaluationDetails"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"log_analytics_workspace_id":{"references":["var.log_analytics_workspace_id"]},"metric":[{"category":{"constant_value":"AllMetrics"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"name":{"constant_value":"DiagnosticsSettings"},"target_resource_id":{"references":["azurerm_key_vault.key_vault.id","azurerm_key_vault.key_vault"]}},"schema_version":0}],"variables":{"bypass":{"default":"AzureServices","description":"(Required) Specifies which traffic can bypass the network rules. Possible values are AzureServices and None."},"default_action":{"default":"Allow","description":"(Required) The Default Action to use when no rules match from ip_rules / virtual_network_subnet_ids. Possible values are Allow and Deny."},"enable_rbac_authorization":{"default":false,"description":"(Optional) Boolean flag to specify whether Azure Key Vault uses Role Based Access Control (RBAC) for authorization of data actions. Defaults to false."},"enabled_for_deployment":{"default":false,"description":"(Optional) Boolean flag to specify whether Azure Virtual Machines are permitted to retrieve certificates stored as secrets from the key vault. Defaults to false."},"enabled_for_disk_encryption":{"default":false,"description":" (Optional) Boolean flag to specify whether Azure Disk Encryption is permitted to retrieve secrets from the vault and unwrap keys. Defaults to false."},"enabled_for_template_deployment":{"default":false,"description":"(Optional) Boolean flag to specify whether Azure Resource Manager is permitted to retrieve secrets from the key vault. Defaults to false."},"ip_rules":{"default":[],"description":"(Optional) One or more IP Addresses, or CIDR Blocks which should be able to access the Key Vault."},"location":{"description":"(Required) Specifies the location where the key vault will be deployed."},"log_analytics_retention_days":{"default":7,"description":"Specifies the number of days of the retention policy"},"log_analytics_workspace_id":{"description":"Specifies the log analytics workspace id"},"name":{"description":"(Required) Specifies the name of the key vault."},"purge_protection_enabled":{"default":false,"description":"(Optional) Is Purge Protection enabled for this Key Vault? Defaults to false."},"resource_group_name":{"description":"(Required) Specifies the resource group name of the key vault."},"sku_name":{"default":"standard","description":"(Required) The Name of the SKU used for this Key Vault. Possible values are standard and premium."},"soft_delete_retention_days":{"default":30,"description":"(Optional) The number of days that items should be retained for once soft-deleted. This value can be between 7 and 90 (the default) days."},"tags":{"default":{},"description":"(Optional) Specifies the tags of the log analytics workspace"},"tenant_id":{"description":"(Required) The Azure Active Directory tenant ID that should be used for authenticating requests to the key vault."},"virtual_network_subnet_ids":{"default":[],"description":"(Optional) One or more Subnet ID's which should be able to access this Key Vault."}}}},"key_vault_private_dns_zone":{"source":"./modules/private_dns_zone","expressions":{"name":{"constant_value":"privatelink.vaultcore.azure.net"},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"tags":{"references":["var.tags"]},"virtual_networks_to_link":{"references":["module.virtual_network.name","module.virtual_network","data.azurerm_client_config.current.subscription_id","data.azurerm_client_config.current","azurerm_resource_group.rg.name","azurerm_resource_group.rg"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_private_dns_zone.private_dns_zone.id","azurerm_private_dns_zone.private_dns_zone"]},"description":"Specifies the resource id of the private dns zone"}},"resources":[{"address":"azurerm_private_dns_zone.private_dns_zone","mode":"managed","type":"azurerm_private_dns_zone","name":"private_dns_zone","provider_config_key":"azurerm","expressions":{"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_private_dns_zone_virtual_network_link.link","mode":"managed","type":"azurerm_private_dns_zone_virtual_network_link","name":"link","provider_config_key":"azurerm","expressions":{"name":{"references":["each.key"]},"private_dns_zone_name":{"references":["azurerm_private_dns_zone.private_dns_zone.name","azurerm_private_dns_zone.private_dns_zone"]},"resource_group_name":{"references":["var.resource_group_name"]},"virtual_network_id":{"references":["each.value.subscription_id","each.value","each.value.resource_group_name","each.value","each.key"]}},"schema_version":0,"for_each_expression":{"references":["var.virtual_networks_to_link"]}}],"variables":{"name":{"description":"(Required) Specifies the name of the private dns zone"},"resource_group_name":{"description":"(Required) Specifies the resource group name of the private dns zone"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the private dns zone"},"virtual_networks_to_link":{"default":{},"description":"(Optional) Specifies the subscription id, resource group name, and name of the virtual networks to which create a virtual network link"}}}},"key_vault_private_endpoint":{"source":"./modules/private_endpoint","expressions":{"is_manual_connection":{"constant_value":false},"location":{"references":["var.location"]},"name":{"references":["module.key_vault.name","module.key_vault"]},"private_connection_resource_id":{"references":["module.key_vault.id","module.key_vault"]},"private_dns_zone_group_ids":{"references":["module.key_vault_private_dns_zone.id","module.key_vault_private_dns_zone"]},"private_dns_zone_group_name":{"constant_value":"KeyVaultPrivateDnsZoneGroup"},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"subnet_id":{"references":["module.virtual_network.subnet_ids","module.virtual_network","var.vm_subnet_name"]},"subresource_name":{"constant_value":"vault"},"tags":{"references":["var.tags"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.id","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the resource id of the private endpoint."},"private_dns_zone_configs":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.private_dns_zone_configs","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the private dns zone(s) configuration"},"private_dns_zone_group":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.private_dns_zone_group","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the private dns zone group of the private endpoint."}},"resources":[{"address":"azurerm_private_endpoint.private_endpoint","mode":"managed","type":"azurerm_private_endpoint","name":"private_endpoint","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.name"]},"private_dns_zone_group":[{"name":{"references":["var.private_dns_zone_group_name"]},"private_dns_zone_ids":{"references":["var.private_dns_zone_group_ids"]}}],"private_service_connection":[{"is_manual_connection":{"references":["var.is_manual_connection"]},"name":{"references":["var.name"]},"private_connection_resource_id":{"references":["var.private_connection_resource_id"]},"request_message":{"references":["var.request_message"]},"subresource_names":{"references":["var.subresource_name"]}}],"resource_group_name":{"references":["var.resource_group_name"]},"subnet_id":{"references":["var.subnet_id"]},"tags":{"references":["var.tags"]}},"schema_version":0}],"variables":{"is_manual_connection":{"default":"false","description":"(Optional) Specifies whether the private endpoint connection requires manual approval from the remote resource owner."},"location":{"description":"(Required) Specifies the supported Azure location where the resource exists. Changing this forces a new resource to be created."},"name":{"description":"(Required) Specifies the name of the private endpoint. Changing this forces a new resource to be created."},"private_connection_resource_id":{"description":"(Required) Specifies the resource id of the private link service"},"private_dns":{"default":{}},"private_dns_zone_group_ids":{"description":"(Required) Specifies the list of Private DNS Zones to include within the private_dns_zone_group."},"private_dns_zone_group_name":{"description":"(Required) Specifies the Name of the Private DNS Zone Group. Changing this forces a new private_dns_zone_group resource to be created."},"request_message":{"default":null,"description":"(Optional) Specifies a message passed to the owner of the remote resource when the private endpoint attempts to establish the connection to the remote resource."},"resource_group_name":{"description":"(Required) The name of the resource group. Changing this forces a new resource to be created."},"subnet_id":{"description":"(Required) Specifies the resource id of the subnet"},"subresource_name":{"default":null,"description":"(Optional) Specifies a subresource name which the Private Endpoint is able to connect to."},"tags":{"default":{},"description":"(Optional) Specifies the tags of the network security group"}}}},"log_analytics_workspace":{"source":"./modules/log_analytics","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.log_analytics_workspace_name","var.name_prefix","var.log_analytics_workspace_name"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"solution_plan_map":{"references":["var.solution_plan_map"]},"tags":{"references":["var.tags"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_log_analytics_workspace.log_analytics_workspace.id","azurerm_log_analytics_workspace.log_analytics_workspace"]},"description":"Specifies the resource id of the log analytics workspace"},"location":{"expression":{"references":["azurerm_log_analytics_workspace.log_analytics_workspace.location","azurerm_log_analytics_workspace.log_analytics_workspace"]},"description":"Specifies the location of the log analytics workspace"},"name":{"expression":{"references":["azurerm_log_analytics_workspace.log_analytics_workspace.name","azurerm_log_analytics_workspace.log_analytics_workspace"]},"description":"Specifies the name of the log analytics workspace"},"primary_shared_key":{"sensitive":true,"expression":{"references":["azurerm_log_analytics_workspace.log_analytics_workspace.primary_shared_key","azurerm_log_analytics_workspace.log_analytics_workspace"]},"description":"Specifies the workspace key of the log analytics workspace"},"resource_group_name":{"expression":{"references":["azurerm_log_analytics_workspace.log_analytics_workspace.resource_group_name","azurerm_log_analytics_workspace.log_analytics_workspace"]},"description":"Specifies the name of the resource group that contains the log analytics workspace"},"workspace_id":{"expression":{"references":["azurerm_log_analytics_workspace.log_analytics_workspace.workspace_id","azurerm_log_analytics_workspace.log_analytics_workspace"]},"description":"Specifies the workspace id of the log analytics workspace"}},"resources":[{"address":"azurerm_log_analytics_solution.la_solution","mode":"managed","type":"azurerm_log_analytics_solution","name":"la_solution","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"plan":[{"product":{"references":["each.value.product","each.value"]},"publisher":{"references":["each.value.publisher","each.value"]}}],"resource_group_name":{"references":["var.resource_group_name"]},"solution_name":{"references":["each.key"]},"workspace_name":{"references":["azurerm_log_analytics_workspace.log_analytics_workspace.name","azurerm_log_analytics_workspace.log_analytics_workspace"]},"workspace_resource_id":{"references":["azurerm_log_analytics_workspace.log_analytics_workspace.id","azurerm_log_analytics_workspace.log_analytics_workspace"]}},"schema_version":1,"for_each_expression":{"references":["var.solution_plan_map"]}},{"address":"azurerm_log_analytics_workspace.log_analytics_workspace","mode":"managed","type":"azurerm_log_analytics_workspace","name":"log_analytics_workspace","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"retention_in_days":{"references":["var.retention_in_days","var.retention_in_days"]},"sku":{"references":["var.sku"]},"tags":{"references":["var.tags"]}},"schema_version":3}],"variables":{"location":{"description":"(Required) Specifies the location of the log analytics workspace"},"name":{"description":"(Required) Specifies the name of the log analytics workspace"},"resource_group_name":{"description":"(Required) Specifies the resource group name"},"retention_in_days":{"default":30,"description":" (Optional) Specifies the workspace data retention in days. Possible values are either 7 (Free Tier only) or range between 30 and 730."},"sku":{"default":"PerGB2018","description":"(Optional) Specifies the sku of the log analytics workspace"},"solution_plan_map":{"default":{},"description":"(Optional) Specifies the map structure containing the list of solutions to be enabled."},"tags":{"default":{},"description":"(Optional) Specifies the tags of the log analytics workspace"}}}},"nat_gateway":{"source":"./modules/nat_gateway","expressions":{"idle_timeout_in_minutes":{"references":["var.nat_gateway_idle_timeout_in_minutes"]},"location":{"references":["var.location"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.nat_gateway_name","var.name_prefix","var.nat_gateway_name"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"sku_name":{"references":["var.nat_gateway_sku_name"]},"subnet_ids":{"references":["module.virtual_network.subnet_ids","module.virtual_network"]},"tags":{"references":["var.tags"]},"zones":{"references":["var.nat_gateway_zones"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_nat_gateway.nat_gateway.id","azurerm_nat_gateway.nat_gateway"]},"description":"Specifies the resource id of the Azure NAT Gateway"},"name":{"expression":{"references":["azurerm_nat_gateway.nat_gateway.name","azurerm_nat_gateway.nat_gateway"]},"description":"Specifies the name of the Azure NAT Gateway"},"public_ip_address":{"expression":{"references":["azurerm_public_ip.nat_gategay_public_ip.ip_address","azurerm_public_ip.nat_gategay_public_ip"]},"description":"Contains the public IP address of the Azure NAT Gateway."}},"resources":[{"address":"azurerm_nat_gateway.nat_gateway","mode":"managed","type":"azurerm_nat_gateway","name":"nat_gateway","provider_config_key":"azurerm","expressions":{"idle_timeout_in_minutes":{"references":["var.idle_timeout_in_minutes"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"sku_name":{"references":["var.sku_name"]},"tags":{"references":["var.tags"]},"zones":{"references":["var.zones"]}},"schema_version":0},{"address":"azurerm_nat_gateway_public_ip_association.nat_gategay_public_ip_association","mode":"managed","type":"azurerm_nat_gateway_public_ip_association","name":"nat_gategay_public_ip_association","provider_config_key":"azurerm","expressions":{"nat_gateway_id":{"references":["azurerm_nat_gateway.nat_gateway.id","azurerm_nat_gateway.nat_gateway"]},"public_ip_address_id":{"references":["azurerm_public_ip.nat_gategay_public_ip.id","azurerm_public_ip.nat_gategay_public_ip"]}},"schema_version":0},{"address":"azurerm_public_ip.nat_gategay_public_ip","mode":"managed","type":"azurerm_public_ip","name":"nat_gategay_public_ip","provider_config_key":"azurerm","expressions":{"allocation_method":{"constant_value":"Static"},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"sku":{"constant_value":"Standard"},"tags":{"references":["var.tags"]},"zones":{"references":["var.zones"]}},"schema_version":0},{"address":"azurerm_subnet_nat_gateway_association.nat-avd-sessionhosts","mode":"managed","type":"azurerm_subnet_nat_gateway_association","name":"nat-avd-sessionhosts","provider_config_key":"azurerm","expressions":{"nat_gateway_id":{"references":["azurerm_nat_gateway.nat_gateway.id","azurerm_nat_gateway.nat_gateway"]},"subnet_id":{"references":["each.value"]}},"schema_version":0,"for_each_expression":{"references":["var.subnet_ids"]}}],"variables":{"idle_timeout_in_minutes":{"default":4,"description":"(Optional) The idle timeout which should be used in minutes. Defaults to 4."},"location":{"description":"(Required) Specifies the location of the Azure OpenAI Service"},"name":{"description":"(Required) Specifies the name of the Azure OpenAI Service"},"resource_group_name":{"description":"(Required) Specifies the resource group name"},"sku_name":{"default":"Standard","description":"(Optional) The SKU which should be used. At this time the only supported value is Standard. Defaults to Standard"},"subnet_ids":{"description":"(Required) A map of subnet ids to associate with the NAT Gateway"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the Azure OpenAI Service"},"zones":{"default":[],"description":" (Optional) A list of Availability Zones in which this NAT Gateway should be located. Changing this forces a new NAT Gateway to be created."}}}},"node_pool":{"source":"./modules/node_pool","expressions":{"availability_zones":{"references":["var.user_node_pool_availability_zones"]},"enable_auto_scaling":{"references":["var.user_node_pool_enable_auto_scaling"]},"enable_host_encryption":{"references":["var.user_node_pool_enable_host_encryption"]},"enable_node_public_ip":{"references":["var.user_node_pool_enable_node_public_ip"]},"kubernetes_cluster_id":{"references":["module.aks_cluster.id","module.aks_cluster"]},"max_count":{"references":["var.user_node_pool_max_count"]},"max_pods":{"references":["var.user_node_pool_max_pods"]},"min_count":{"references":["var.user_node_pool_min_count"]},"mode":{"references":["var.user_node_pool_mode"]},"name":{"references":["var.user_node_pool_name"]},"node_count":{"references":["var.user_node_pool_node_count"]},"node_labels":{"references":["var.user_node_pool_node_labels"]},"node_taints":{"references":["var.user_node_pool_node_taints"]},"orchestrator_version":{"references":["var.kubernetes_version"]},"os_type":{"references":["var.user_node_pool_os_type"]},"pod_subnet_id":{"references":["module.virtual_network.subnet_ids","module.virtual_network","var.pod_subnet_name"]},"priority":{"references":["var.user_node_pool_priority"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"tags":{"references":["var.tags"]},"vm_size":{"references":["var.user_node_pool_vm_size"]},"vnet_subnet_id":{"references":["module.virtual_network.subnet_ids","module.virtual_network","var.user_node_pool_subnet_name"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_kubernetes_cluster_node_pool.node_pool.id","azurerm_kubernetes_cluster_node_pool.node_pool"]},"description":"Specifies the resource id of the node pool"}},"resources":[{"address":"azurerm_kubernetes_cluster_node_pool.node_pool","mode":"managed","type":"azurerm_kubernetes_cluster_node_pool","name":"node_pool","provider_config_key":"azurerm","expressions":{"enable_auto_scaling":{"references":["var.enable_auto_scaling"]},"enable_host_encryption":{"references":["var.enable_host_encryption"]},"enable_node_public_ip":{"references":["var.enable_node_public_ip"]},"kubernetes_cluster_id":{"references":["var.kubernetes_cluster_id"]},"max_count":{"references":["var.max_count"]},"max_pods":{"references":["var.max_pods"]},"min_count":{"references":["var.min_count"]},"mode":{"references":["var.mode"]},"name":{"references":["var.name"]},"node_count":{"references":["var.node_count"]},"node_labels":{"references":["var.node_labels"]},"node_taints":{"references":["var.node_taints"]},"orchestrator_version":{"references":["var.orchestrator_version"]},"os_disk_size_gb":{"references":["var.os_disk_size_gb"]},"os_disk_type":{"references":["var.os_disk_type"]},"os_type":{"references":["var.os_type"]},"pod_subnet_id":{"references":["var.pod_subnet_id"]},"priority":{"references":["var.priority"]},"proximity_placement_group_id":{"references":["var.proximity_placement_group_id"]},"tags":{"references":["var.tags"]},"vm_size":{"references":["var.vm_size"]},"vnet_subnet_id":{"references":["var.vnet_subnet_id"]},"zones":{"references":["var.availability_zones"]}},"schema_version":1}],"variables":{"availability_zones":{"default":["1","2","3"],"description":"(Optional) A list of Availability Zones where the Nodes in this Node Pool should be created in. Changing this forces a new resource to be created."},"enable_auto_scaling":{"default":false,"description":"(Optional) Whether to enable auto-scaler. Defaults to false."},"enable_host_encryption":{"default":false,"description":"(Optional) Should the nodes in this Node Pool have host encryption enabled? Defaults to false."},"enable_node_public_ip":{"default":false,"description":"(Optional) Should each node have a Public IP Address? Defaults to false. Changing this forces a new resource to be created."},"kubernetes_cluster_id":{"description":"(Required) Specifies the resource id of the AKS cluster."},"max_count":{"default":10,"description":"(Required) The maximum number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be greater than or equal to min_count."},"max_pods":{"default":250,"description":"(Optional) The maximum number of pods that can run on each agent. Changing this forces a new resource to be created."},"min_count":{"default":3,"description":"(Required) The minimum number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be less than or equal to max_count."},"mode":{"default":"User","description":"(Optional) Should this Node Pool be used for System or User resources? Possible values are System and User. Defaults to User."},"name":{"description":"(Required) Specifies the name of the node pool."},"node_count":{"default":3,"description":"(Optional) The initial number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be a value in the range min_count - max_count."},"node_labels":{"default":{},"description":"(Optional) A list of Kubernetes taints which should be applied to nodes in the agent pool (e.g key=value:NoSchedule). Changing this forces a new resource to be created."},"node_taints":{"default":["CriticalAddonsOnly=true:NoSchedule"],"description":"(Optional) A map of Kubernetes labels which should be applied to nodes in this Node Pool. Changing this forces a new resource to be created."},"oidc_issuer_enabled":{"default":true,"description":" (Optional) Enable or Disable the OIDC issuer URL."},"orchestrator_version":{"default":null,"description":"(Optional) Version of Kubernetes used for the Agents. If not specified, the latest recommended version will be used at provisioning time (but won't auto-upgrade)"},"os_disk_size_gb":{"default":null,"description":"(Optional) The Agent Operating System disk size in GB. Changing this forces a new resource to be created."},"os_disk_type":{"default":"Ephemeral","description":"(Optional) The type of disk which should be used for the Operating System. Possible values are Ephemeral and Managed. Defaults to Managed. Changing this forces a new resource to be created."},"os_type":{"default":"Linux","description":"(Optional) The Operating System which should be used for this Node Pool. Changing this forces a new resource to be created. Possible values are Linux and Windows. Defaults to Linux."},"pod_subnet_id":{"default":null,"description":"(Optional) The ID of the Subnet where the pods in the system node pool should exist. Changing this forces a new resource to be created."},"priority":{"default":"Regular","description":"(Optional) The Priority for Virtual Machines within the Virtual Machine Scale Set that powers this Node Pool. Possible values are Regular and Spot. Defaults to Regular. Changing this forces a new resource to be created."},"proximity_placement_group_id":{"default":null,"description":"(Optional) The ID of the Proximity Placement Group where the Virtual Machine Scale Set that powers this Node Pool will be placed. Changing this forces a new resource to be created."},"resource_group_name":{"description":"Specifies the resource group name"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the network security group"},"vm_size":{"description":"(Required) The SKU which should be used for the Virtual Machines used in this Node Pool. Changing this forces a new resource to be created."},"vnet_subnet_id":{"default":null,"description":"(Optional) The ID of the Subnet where this Node Pool should exist."}}}},"openai":{"source":"./modules/openai","expressions":{"custom_subdomain_name":{"references":["var.openai_custom_subdomain_name","var.openai_custom_subdomain_name","var.name_prefix","random_string.prefix.result","random_string.prefix","var.openai_name","var.name_prefix","var.openai_name","var.openai_custom_subdomain_name"]},"deployments":{"references":["var.openai_deployments"]},"location":{"references":["var.location"]},"log_analytics_retention_days":{"references":["var.log_analytics_retention_days"]},"log_analytics_workspace_id":{"references":["module.log_analytics_workspace.id","module.log_analytics_workspace"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.openai_name","var.name_prefix","var.openai_name"]},"public_network_access_enabled":{"references":["var.openai_public_network_access_enabled"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"sku_name":{"references":["var.openai_sku_name"]},"tags":{"references":["var.tags"]}},"module":{"outputs":{"endpoint":{"expression":{"references":["azurerm_cognitive_account.openai.endpoint","azurerm_cognitive_account.openai"]},"description":"Specifies the endpoint of the Azure OpenAI Service."},"id":{"expression":{"references":["azurerm_cognitive_account.openai.id","azurerm_cognitive_account.openai"]},"description":"Specifies the resource id of the log analytics workspace"},"location":{"expression":{"references":["azurerm_cognitive_account.openai.location","azurerm_cognitive_account.openai"]},"description":"Specifies the location of the log analytics workspace"},"name":{"expression":{"references":["azurerm_cognitive_account.openai.name","azurerm_cognitive_account.openai"]},"description":"Specifies the name of the log analytics workspace"},"primary_access_key":{"expression":{"references":["azurerm_cognitive_account.openai.endpoint","azurerm_cognitive_account.openai"]},"description":"Specifies the primary access key of the Azure OpenAI Service."},"resource_group_name":{"expression":{"references":["azurerm_cognitive_account.openai.resource_group_name","azurerm_cognitive_account.openai"]},"description":"Specifies the name of the resource group that contains the log analytics workspace"},"secondary_access_key":{"expression":{"references":["azurerm_cognitive_account.openai.endpoint","azurerm_cognitive_account.openai"]},"description":"Specifies the secondary access key of the Azure OpenAI Service."}},"resources":[{"address":"azurerm_cognitive_account.openai","mode":"managed","type":"azurerm_cognitive_account","name":"openai","provider_config_key":"azurerm","expressions":{"custom_subdomain_name":{"references":["var.custom_subdomain_name"]},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"kind":{"constant_value":"OpenAI"},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"public_network_access_enabled":{"references":["var.public_network_access_enabled"]},"resource_group_name":{"references":["var.resource_group_name"]},"sku_name":{"references":["var.sku_name"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_cognitive_deployment.deployment","mode":"managed","type":"azurerm_cognitive_deployment","name":"deployment","provider_config_key":"azurerm","expressions":{"cognitive_account_id":{"references":["azurerm_cognitive_account.openai.id","azurerm_cognitive_account.openai"]},"model":[{"format":{"constant_value":"OpenAI"},"name":{"references":["each.value.model.name","each.value.model","each.value"]},"version":{"references":["each.value.model.version","each.value.model","each.value"]}}],"name":{"references":["each.key"]},"scale":[{"type":{"constant_value":"Standard"}}]},"schema_version":0,"for_each_expression":{"references":["var.deployments"]}},{"address":"azurerm_monitor_diagnostic_setting.settings","mode":"managed","type":"azurerm_monitor_diagnostic_setting","name":"settings","provider_config_key":"azurerm","expressions":{"enabled_log":[{"category":{"constant_value":"Audit"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"RequestResponse"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]},{"category":{"constant_value":"Trace"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"log_analytics_workspace_id":{"references":["var.log_analytics_workspace_id"]},"metric":[{"category":{"constant_value":"AllMetrics"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"name":{"constant_value":"DiagnosticsSettings"},"target_resource_id":{"references":["azurerm_cognitive_account.openai.id","azurerm_cognitive_account.openai"]}},"schema_version":0}],"variables":{"custom_subdomain_name":{"description":"(Optional) Specifies the custom subdomain name of the Azure OpenAI Service"},"deployments":{"default":[{"model":{"name":"gpt-35-turbo","version":"0301"},"name":"gpt-35-turbo","rai_policy_name":""}],"description":"(Optional) Specifies the deployments of the Azure OpenAI Service"},"location":{"description":"(Required) Specifies the location of the Azure OpenAI Service"},"log_analytics_retention_days":{"default":7,"description":"Specifies the number of days of the retention policy"},"log_analytics_workspace_id":{"description":"Specifies the log analytics workspace id"},"name":{"description":"(Required) Specifies the name of the Azure OpenAI Service"},"public_network_access_enabled":{"default":true,"description":"(Optional) Specifies whether public network access is allowed for the Azure OpenAI Service"},"resource_group_name":{"description":"(Required) Specifies the resource group name"},"sku_name":{"default":"S0","description":"(Optional) Specifies the sku name for the Azure OpenAI Service"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the Azure OpenAI Service"}}}},"openai_private_dns_zone":{"source":"./modules/private_dns_zone","expressions":{"name":{"constant_value":"privatelink.openai.azure.com"},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"tags":{"references":["var.tags"]},"virtual_networks_to_link":{"references":["module.virtual_network.name","module.virtual_network","data.azurerm_client_config.current.subscription_id","data.azurerm_client_config.current","azurerm_resource_group.rg.name","azurerm_resource_group.rg"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_private_dns_zone.private_dns_zone.id","azurerm_private_dns_zone.private_dns_zone"]},"description":"Specifies the resource id of the private dns zone"}},"resources":[{"address":"azurerm_private_dns_zone.private_dns_zone","mode":"managed","type":"azurerm_private_dns_zone","name":"private_dns_zone","provider_config_key":"azurerm","expressions":{"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_private_dns_zone_virtual_network_link.link","mode":"managed","type":"azurerm_private_dns_zone_virtual_network_link","name":"link","provider_config_key":"azurerm","expressions":{"name":{"references":["each.key"]},"private_dns_zone_name":{"references":["azurerm_private_dns_zone.private_dns_zone.name","azurerm_private_dns_zone.private_dns_zone"]},"resource_group_name":{"references":["var.resource_group_name"]},"virtual_network_id":{"references":["each.value.subscription_id","each.value","each.value.resource_group_name","each.value","each.key"]}},"schema_version":0,"for_each_expression":{"references":["var.virtual_networks_to_link"]}}],"variables":{"name":{"description":"(Required) Specifies the name of the private dns zone"},"resource_group_name":{"description":"(Required) Specifies the resource group name of the private dns zone"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the private dns zone"},"virtual_networks_to_link":{"default":{},"description":"(Optional) Specifies the subscription id, resource group name, and name of the virtual networks to which create a virtual network link"}}}},"openai_private_endpoint":{"source":"./modules/private_endpoint","expressions":{"is_manual_connection":{"constant_value":false},"location":{"references":["var.location"]},"name":{"references":["module.openai.name","module.openai"]},"private_connection_resource_id":{"references":["module.openai.id","module.openai"]},"private_dns_zone_group_ids":{"references":["module.openai_private_dns_zone.id","module.openai_private_dns_zone"]},"private_dns_zone_group_name":{"constant_value":"AcrPrivateDnsZoneGroup"},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"subnet_id":{"references":["module.virtual_network.subnet_ids","module.virtual_network","var.vm_subnet_name"]},"subresource_name":{"constant_value":"account"},"tags":{"references":["var.tags"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.id","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the resource id of the private endpoint."},"private_dns_zone_configs":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.private_dns_zone_configs","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the private dns zone(s) configuration"},"private_dns_zone_group":{"expression":{"references":["azurerm_private_endpoint.private_endpoint.private_dns_zone_group","azurerm_private_endpoint.private_endpoint"]},"description":"Specifies the private dns zone group of the private endpoint."}},"resources":[{"address":"azurerm_private_endpoint.private_endpoint","mode":"managed","type":"azurerm_private_endpoint","name":"private_endpoint","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.name"]},"private_dns_zone_group":[{"name":{"references":["var.private_dns_zone_group_name"]},"private_dns_zone_ids":{"references":["var.private_dns_zone_group_ids"]}}],"private_service_connection":[{"is_manual_connection":{"references":["var.is_manual_connection"]},"name":{"references":["var.name"]},"private_connection_resource_id":{"references":["var.private_connection_resource_id"]},"request_message":{"references":["var.request_message"]},"subresource_names":{"references":["var.subresource_name"]}}],"resource_group_name":{"references":["var.resource_group_name"]},"subnet_id":{"references":["var.subnet_id"]},"tags":{"references":["var.tags"]}},"schema_version":0}],"variables":{"is_manual_connection":{"default":"false","description":"(Optional) Specifies whether the private endpoint connection requires manual approval from the remote resource owner."},"location":{"description":"(Required) Specifies the supported Azure location where the resource exists. Changing this forces a new resource to be created."},"name":{"description":"(Required) Specifies the name of the private endpoint. Changing this forces a new resource to be created."},"private_connection_resource_id":{"description":"(Required) Specifies the resource id of the private link service"},"private_dns":{"default":{}},"private_dns_zone_group_ids":{"description":"(Required) Specifies the list of Private DNS Zones to include within the private_dns_zone_group."},"private_dns_zone_group_name":{"description":"(Required) Specifies the Name of the Private DNS Zone Group. Changing this forces a new private_dns_zone_group resource to be created."},"request_message":{"default":null,"description":"(Optional) Specifies a message passed to the owner of the remote resource when the private endpoint attempts to establish the connection to the remote resource."},"resource_group_name":{"description":"(Required) The name of the resource group. Changing this forces a new resource to be created."},"subnet_id":{"description":"(Required) Specifies the resource id of the subnet"},"subresource_name":{"default":null,"description":"(Optional) Specifies a subresource name which the Private Endpoint is able to connect to."},"tags":{"default":{},"description":"(Optional) Specifies the tags of the network security group"}}}},"storage_account":{"source":"./modules/storage_account","expressions":{"account_kind":{"references":["var.storage_account_kind"]},"account_tier":{"references":["var.storage_account_tier"]},"location":{"references":["var.location"]},"name":{"references":["local.storage_account_prefix","random_string.storage_account_suffix.result","random_string.storage_account_suffix"]},"replication_type":{"references":["var.storage_account_replication_type"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"tags":{"references":["var.tags"]}},"module":{"outputs":{"id":{"expression":{"references":["azurerm_storage_account.storage_account.id","azurerm_storage_account.storage_account"]},"description":"Specifies the resource id of the storage account"},"name":{"expression":{"references":["azurerm_storage_account.storage_account.name","azurerm_storage_account.storage_account"]},"description":"Specifies the name of the storage account"},"primary_access_key":{"expression":{"references":["azurerm_storage_account.storage_account.primary_access_key","azurerm_storage_account.storage_account"]},"description":"Specifies the primary access key of the storage account"},"primary_blob_endpoint":{"expression":{"references":["azurerm_storage_account.storage_account.primary_blob_endpoint","azurerm_storage_account.storage_account"]},"description":"Specifies the primary blob endpoint of the storage account"},"principal_id":{"expression":{"references":["azurerm_storage_account.storage_account.identity[0].principal_id","azurerm_storage_account.storage_account.identity[0]","azurerm_storage_account.storage_account.identity","azurerm_storage_account.storage_account"]},"description":"Specifies the principal id of the system assigned managed identity of the storage account"}},"resources":[{"address":"azurerm_storage_account.storage_account","mode":"managed","type":"azurerm_storage_account","name":"storage_account","provider_config_key":"azurerm","expressions":{"account_kind":{"references":["var.account_kind"]},"account_replication_type":{"references":["var.replication_type"]},"account_tier":{"references":["var.account_tier"]},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"is_hns_enabled":{"references":["var.is_hns_enabled"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_rules":[{"default_action":{"references":["var.ip_rules","var.virtual_network_subnet_ids","var.default_action"]},"ip_rules":{"references":["var.ip_rules"]},"virtual_network_subnet_ids":{"references":["var.virtual_network_subnet_ids"]}}],"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":3}],"variables":{"account_kind":{"default":"StorageV2","description":"(Optional) Specifies the account kind of the storage account"},"account_tier":{"default":"Standard","description":"(Optional) Specifies the account tier of the storage account"},"default_action":{"default":"Allow","description":"Allow or disallow public access to all blobs or containers in the storage accounts. The default interpretation is true for this property."},"ip_rules":{"default":[],"description":"Specifies IP rules for the storage account"},"is_hns_enabled":{"default":false,"description":"(Optional) Specifies the replication type of the storage account"},"kind":{"default":"","description":"(Optional) Specifies the kind of the storage account"},"location":{"description":"(Required) Specifies the location of the storage account"},"name":{"description":"(Required) Specifies the name of the storage account"},"replication_type":{"default":"LRS","description":"(Optional) Specifies the replication type of the storage account"},"resource_group_name":{"description":"(Required) Specifies the resource group name of the storage account"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the storage account"},"virtual_network_subnet_ids":{"default":[],"description":"Specifies a list of resource ids for subnets"}}}},"virtual_machine":{"source":"./modules/virtual_machine","expressions":{"admin_ssh_public_key":{"references":["var.ssh_public_key"]},"boot_diagnostics_storage_account":{"references":["module.storage_account.primary_blob_endpoint","module.storage_account"]},"location":{"references":["var.location"]},"log_analytics_retention_days":{"references":["var.log_analytics_retention_days"]},"log_analytics_workspace_id":{"references":["module.log_analytics_workspace.workspace_id","module.log_analytics_workspace"]},"log_analytics_workspace_key":{"references":["module.log_analytics_workspace.primary_shared_key","module.log_analytics_workspace"]},"log_analytics_workspace_resource_id":{"references":["module.log_analytics_workspace.id","module.log_analytics_workspace"]},"name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.vm_name","var.name_prefix","var.vm_name"]},"os_disk_image":{"references":["var.vm_os_disk_image"]},"os_disk_storage_account_type":{"references":["var.vm_os_disk_storage_account_type"]},"public_ip":{"references":["var.vm_public_ip"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"size":{"references":["var.vm_size"]},"subnet_id":{"references":["module.virtual_network.subnet_ids","module.virtual_network","var.vm_subnet_name"]},"tags":{"references":["var.tags"]},"vm_user":{"references":["var.admin_username"]}},"count_expression":{"references":["var.vm_enabled"]},"module":{"outputs":{"public_ip":{"expression":{"references":["azurerm_linux_virtual_machine.virtual_machine.public_ip_address","azurerm_linux_virtual_machine.virtual_machine"]},"description":"Specifies the public IP address of the virtual machine"},"username":{"expression":{"references":["var.vm_user"]},"description":"Specifies the username of the virtual machine"}},"resources":[{"address":"azurerm_linux_virtual_machine.virtual_machine","mode":"managed","type":"azurerm_linux_virtual_machine","name":"virtual_machine","provider_config_key":"azurerm","expressions":{"admin_ssh_key":[{"public_key":{"references":["var.admin_ssh_public_key"]},"username":{"references":["var.vm_user"]}}],"admin_username":{"references":["var.vm_user"]},"boot_diagnostics":[{"storage_account_uri":{"references":["var.boot_diagnostics_storage_account","var.boot_diagnostics_storage_account"]}}],"computer_name":{"references":["var.name"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_interface_ids":{"references":["azurerm_network_interface.nic.id","azurerm_network_interface.nic"]},"os_disk":[{"caching":{"constant_value":"ReadWrite"},"name":{"references":["var.name"]},"storage_account_type":{"references":["var.os_disk_storage_account_type"]}}],"resource_group_name":{"references":["var.resource_group_name"]},"size":{"references":["var.size"]},"source_image_reference":[{"offer":{"references":["var.os_disk_image"]},"publisher":{"references":["var.os_disk_image"]},"sku":{"references":["var.os_disk_image"]},"version":{"references":["var.os_disk_image"]}}],"tags":{"references":["var.tags"]}},"schema_version":0,"depends_on":["azurerm_network_interface.nic","azurerm_network_security_group.nsg"]},{"address":"azurerm_monitor_data_collection_rule.linux","mode":"managed","type":"azurerm_monitor_data_collection_rule","name":"linux","provider_config_key":"azurerm","expressions":{"data_flow":[{"destinations":{"constant_value":["default"]},"streams":{"constant_value":["Microsoft-InsightsMetrics","Microsoft-Syslog","Microsoft-Perf"]}}],"data_sources":[{"performance_counter":[{"counter_specifiers":{"constant_value":["\\Processor Information(_Total)\\% Processor Time","\\Processor Information(_Total)\\% Privileged Time","\\Processor Information(_Total)\\% User Time","\\Processor Information(_Total)\\Processor Frequency","\\System\\Processes","\\Process(_Total)\\Thread Count","\\Process(_Total)\\Handle Count","\\System\\System Up Time","\\System\\Context Switches/sec","\\System\\Processor Queue Length","\\Memory\\% Committed Bytes In Use","\\Memory\\Available Bytes","\\Memory\\Committed Bytes","\\Memory\\Cache Bytes","\\Memory\\Pool Paged Bytes","\\Memory\\Pool Nonpaged Bytes","\\Memory\\Pages/sec","\\Memory\\Page Faults/sec","\\Process(_Total)\\Working Set","\\Process(_Total)\\Working Set - Private","\\LogicalDisk(_Total)\\% Disk Time","\\LogicalDisk(_Total)\\% Disk Read Time","\\LogicalDisk(_Total)\\% Disk Write Time","\\LogicalDisk(_Total)\\% Idle Time","\\LogicalDisk(_Total)\\Disk Bytes/sec","\\LogicalDisk(_Total)\\Disk Read Bytes/sec","\\LogicalDisk(_Total)\\Disk Write Bytes/sec","\\LogicalDisk(_Total)\\Disk Transfers/sec","\\LogicalDisk(_Total)\\Disk Reads/sec","\\LogicalDisk(_Total)\\Disk Writes/sec","\\LogicalDisk(_Total)\\Avg. Disk sec/Transfer","\\LogicalDisk(_Total)\\Avg. Disk sec/Read","\\LogicalDisk(_Total)\\Avg. Disk sec/Write","\\LogicalDisk(_Total)\\Avg. Disk Queue Length","\\LogicalDisk(_Total)\\Avg. Disk Read Queue Length","\\LogicalDisk(_Total)\\Avg. Disk Write Queue Length","\\LogicalDisk(_Total)\\% Free Space","\\LogicalDisk(_Total)\\Free Megabytes","\\Network Interface(*)\\Bytes Total/sec","\\Network Interface(*)\\Bytes Sent/sec","\\Network Interface(*)\\Bytes Received/sec","\\Network Interface(*)\\Packets/sec","\\Network Interface(*)\\Packets Sent/sec","\\Network Interface(*)\\Packets Received/sec","\\Network Interface(*)\\Packets Outbound Errors","\\Network Interface(*)\\Packets Received Errors"]},"name":{"constant_value":"perfcounter"},"sampling_frequency_in_seconds":{"constant_value":60},"streams":{"constant_value":["Microsoft-Perf","Microsoft-InsightsMetrics"]}}],"syslog":[{"facility_names":{"constant_value":["*"]},"log_levels":{"constant_value":["*"]},"name":{"constant_value":"syslog"}}]}],"destinations":[{"log_analytics":[{"name":{"constant_value":"default"},"workspace_resource_id":{"references":["var.log_analytics_workspace_resource_id"]}}]}],"location":{"references":["var.location"]},"name":{"constant_value":"LinuxVmMonitorDataCollectionRule"},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_monitor_data_collection_rule_association.virtual_machine_association","mode":"managed","type":"azurerm_monitor_data_collection_rule_association","name":"virtual_machine_association","provider_config_key":"azurerm","expressions":{"data_collection_rule_id":{"references":["azurerm_monitor_data_collection_rule.linux.id","azurerm_monitor_data_collection_rule.linux"]},"name":{"constant_value":"LinuxVmMonitorDataCollectionRuleAssociation"},"target_resource_id":{"references":["azurerm_linux_virtual_machine.virtual_machine.id","azurerm_linux_virtual_machine.virtual_machine"]}},"schema_version":0},{"address":"azurerm_network_interface.nic","mode":"managed","type":"azurerm_network_interface","name":"nic","provider_config_key":"azurerm","expressions":{"ip_configuration":[{"name":{"constant_value":"Configuration"},"private_ip_address_allocation":{"constant_value":"Dynamic"},"public_ip_address_id":{"references":["azurerm_public_ip.public_ip[0].id","azurerm_public_ip.public_ip[0]","azurerm_public_ip.public_ip"]},"subnet_id":{"references":["var.subnet_id"]}}],"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_network_interface_security_group_association.nsg_association","mode":"managed","type":"azurerm_network_interface_security_group_association","name":"nsg_association","provider_config_key":"azurerm","expressions":{"network_interface_id":{"references":["azurerm_network_interface.nic.id","azurerm_network_interface.nic"]},"network_security_group_id":{"references":["azurerm_network_security_group.nsg.id","azurerm_network_security_group.nsg"]}},"schema_version":0,"depends_on":["azurerm_network_security_group.nsg"]},{"address":"azurerm_network_security_group.nsg","mode":"managed","type":"azurerm_network_security_group","name":"nsg","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"security_rule":{"constant_value":[{"access":"Allow","description":null,"destination_address_prefix":"*","destination_address_prefixes":null,"destination_application_security_group_ids":null,"destination_port_range":"22","destination_port_ranges":null,"direction":"Inbound","name":"SSH","priority":1001,"protocol":"Tcp","source_address_prefix":"*","source_address_prefixes":null,"source_application_security_group_ids":null,"source_port_range":"*","source_port_ranges":null}]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_public_ip.public_ip","mode":"managed","type":"azurerm_public_ip","name":"public_ip","provider_config_key":"azurerm","expressions":{"allocation_method":{"constant_value":"Dynamic"},"domain_name_label":{"references":["var.name"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":0,"count_expression":{"references":["var.public_ip"]}},{"address":"azurerm_virtual_machine_extension.azure_monitor_agent","mode":"managed","type":"azurerm_virtual_machine_extension","name":"azure_monitor_agent","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"automatic_upgrade_enabled":{"constant_value":true},"name":{"references":["var.name"]},"publisher":{"constant_value":"Microsoft.Azure.Monitor"},"tags":{"references":["var.tags"]},"type":{"constant_value":"AzureMonitorLinuxAgent"},"type_handler_version":{"constant_value":"1.21"},"virtual_machine_id":{"references":["azurerm_linux_virtual_machine.virtual_machine.id","azurerm_linux_virtual_machine.virtual_machine"]}},"schema_version":0}],"variables":{"admin_ssh_public_key":{"description":"Specifies the public SSH key"},"boot_diagnostics_storage_account":{"default":null,"description":"(Optional) The Primary/Secondary Endpoint for the Azure Storage Account (general purpose) which should be used to store Boot Diagnostics, including Console Output and Screenshots from the Hypervisor."},"location":{"description":"(Required) Specifies the location of the virtual machine"},"log_analytics_retention_days":{"default":7,"description":"Specifies the number of days of the retention policy"},"log_analytics_workspace_id":{"description":"Specifies the log analytics workspace id"},"log_analytics_workspace_key":{"description":"Specifies the log analytics workspace key"},"log_analytics_workspace_resource_id":{"description":"Specifies the log analytics workspace resource id"},"name":{"description":"(Required) Specifies the name of the virtual machine"},"os_disk_image":{"default":{"offer":"0001-com-ubuntu-server-jammy","publisher":"Canonical","sku":"22_04-lts-gen2","version":"latest"},"description":"(Optional) Specifies the os disk image of the virtual machine"},"os_disk_storage_account_type":{"default":"StandardSSD_LRS","description":"(Optional) Specifies the storage account type of the os disk of the virtual machine"},"public_ip":{"default":false,"description":"(Optional) Specifies whether create a public IP for the virtual machine"},"resource_group_name":{"description":"(Required) Specifies the resource group name of the virtual machine"},"size":{"description":"(Required) Specifies the size of the virtual machine"},"subnet_id":{"description":"(Required) Specifies the resource id of the subnet hosting the virtual machine"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the storage account"},"vm_user":{"default":"azadmin","description":"(Required) Specifies the username of the virtual machine"}}}},"virtual_network":{"source":"./modules/virtual_network","expressions":{"address_space":{"references":["var.vnet_address_space"]},"location":{"references":["var.location"]},"log_analytics_retention_days":{"references":["var.log_analytics_retention_days"]},"log_analytics_workspace_id":{"references":["module.log_analytics_workspace.id","module.log_analytics_workspace"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"subnets":{"references":["var.system_node_pool_subnet_name","var.system_node_pool_subnet_address_prefix","var.user_node_pool_subnet_name","var.user_node_pool_subnet_address_prefix","var.pod_subnet_name","var.pod_subnet_address_prefix","var.vm_subnet_name","var.vm_subnet_address_prefix","var.bastion_subnet_address_prefix"]},"tags":{"references":["var.tags"]},"vnet_name":{"references":["var.name_prefix","random_string.prefix.result","random_string.prefix","var.vnet_name","var.name_prefix","var.vnet_name"]}},"module":{"outputs":{"name":{"expression":{"references":["azurerm_virtual_network.vnet.name","azurerm_virtual_network.vnet"]},"description":"Specifies the name of the virtual network"},"subnet_ids":{"expression":{"references":["azurerm_subnet.subnet"]},"description":"Contains a list of the the resource id of the subnets"},"subnet_ids_as_list":{"expression":{"references":["azurerm_subnet.subnet"]},"description":"Returns the list of the subnet ids as a list of strings."},"vnet_id":{"expression":{"references":["azurerm_virtual_network.vnet.id","azurerm_virtual_network.vnet"]},"description":"Specifies the resource id of the virtual network"}},"resources":[{"address":"azurerm_monitor_diagnostic_setting.settings","mode":"managed","type":"azurerm_monitor_diagnostic_setting","name":"settings","provider_config_key":"azurerm","expressions":{"enabled_log":[{"category":{"constant_value":"VMProtectionAlerts"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"log_analytics_workspace_id":{"references":["var.log_analytics_workspace_id"]},"metric":[{"category":{"constant_value":"AllMetrics"},"retention_policy":[{"days":{"references":["var.log_analytics_retention_days"]},"enabled":{"constant_value":true}}]}],"name":{"constant_value":"DiagnosticsSettings"},"target_resource_id":{"references":["azurerm_virtual_network.vnet.id","azurerm_virtual_network.vnet"]}},"schema_version":0},{"address":"azurerm_subnet.subnet","mode":"managed","type":"azurerm_subnet","name":"subnet","provider_config_key":"azurerm","expressions":{"address_prefixes":{"references":["each.value.address_prefixes","each.value"]},"name":{"references":["each.key"]},"private_endpoint_network_policies_enabled":{"references":["each.value.private_endpoint_network_policies_enabled","each.value"]},"private_link_service_network_policies_enabled":{"references":["each.value.private_link_service_network_policies_enabled","each.value"]},"resource_group_name":{"references":["var.resource_group_name"]},"virtual_network_name":{"references":["azurerm_virtual_network.vnet.name","azurerm_virtual_network.vnet"]}},"schema_version":0,"for_each_expression":{"references":["var.subnets"]}},{"address":"azurerm_virtual_network.vnet","mode":"managed","type":"azurerm_virtual_network","name":"vnet","provider_config_key":"azurerm","expressions":{"address_space":{"references":["var.address_space"]},"location":{"references":["var.location"]},"name":{"references":["var.vnet_name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"references":["var.tags"]}},"schema_version":0}],"variables":{"address_space":{"description":"VNET address space"},"location":{"description":"Location in which to deploy the network"},"log_analytics_retention_days":{"default":7,"description":"Specifies the number of days of the retention policy"},"log_analytics_workspace_id":{"description":"Specifies the log analytics workspace id"},"resource_group_name":{"description":"Resource Group name"},"subnets":{"description":"Subnets configuration"},"tags":{"default":{},"description":"(Optional) Specifies the tags of the storage account"},"vnet_name":{"description":"VNET name"}}}}},"variables":{"acr_admin_enabled":{"default":true,"description":"Specifies whether admin is enabled for the container registry"},"acr_georeplication_locations":{"default":[],"description":"(Optional) A list of Azure locations where the container registry should be geo-replicated."},"acr_name":{"default":"Acr","description":"Specifies the name of the container registry"},"acr_sku":{"default":"Premium","description":"Specifies the name of the container registry"},"admin_group_object_ids":{"default":[],"description":"(Optional) A list of Object IDs of Azure Active Directory Groups which should have Admin Role on the Cluster."},"admin_username":{"default":"azadmin","description":"(Required) Specifies the admin username of the jumpbox virtual machine and AKS worker nodes."},"aks_cluster_name":{"default":"Aks","description":"(Required) Specifies the name of the AKS cluster."},"automatic_channel_upgrade":{"default":"stable","description":"(Optional) The upgrade channel for this Kubernetes Cluster. Possible values are patch, rapid, and stable."},"azure_policy_enabled":{"default":true,"description":"(Optional) Should the Azure Policy Add-On be enabled? For more details please visit Understand Azure Policy for Azure Kubernetes Service"},"azure_rbac_enabled":{"default":true,"description":"(Optional) Is Role Based Access Control based on Azure AD enabled?"},"bastion_host_name":{"default":"BastionHost","description":"(Optional) Specifies the name of the bastion host"},"bastion_subnet_address_prefix":{"default":["10.243.2.0/24"],"description":"Specifies the address prefix of the firewall subnet"},"deployment_script_azure_cli_version":{"default":"2.9.1","description":"(Required) Azure CLI module version to be used."},"deployment_script_managed_identity_name":{"default":"ScriptManagedIdentity","description":"Specifies the name of the user-defined managed identity used by the deployment script."},"deployment_script_name":{"default":"BashScript","description":"(Required) Specifies the name of the Azure OpenAI Service"},"deployment_script_primary_script_uri":{"default":"https://paolosalvatori.blob.core.windows.net/scripts/install-nginx-via-helm-and-create-sa.sh","description":"(Optional) Uri for the script. This is the entry point for the external script. Changing this forces a new Resource Deployment Script to be created."},"domain":{"default":"contoso.com","description":"Specifies the domain of the Kubernetes ingress object."},"email":{"default":"paolos@microsoft.com","description":"Specifies the email address for the cert-manager cluster issuer."},"http_application_routing_enabled":{"default":false,"description":"(Optional) Should HTTP Application Routing be enabled?"},"image_cleaner_enabled":{"default":true,"description":"(Optional) Specifies whether Image Cleaner is enabled."},"keda_enabled":{"default":true,"description":"(Optional) Specifies whether KEDA Autoscaler can be used for workloads."},"key_vault_bypass":{"default":"AzureServices","description":"(Required) Specifies which traffic can bypass the network rules. Possible values are AzureServices and None."},"key_vault_default_action":{"default":"Allow","description":"(Required) The Default Action to use when no rules match from ip_rules / virtual_network_subnet_ids. Possible values are Allow and Deny."},"key_vault_enable_rbac_authorization":{"default":true,"description":"(Optional) Boolean flag to specify whether Azure Key Vault uses Role Based Access Control (RBAC) for authorization of data actions. Defaults to false."},"key_vault_enabled_for_deployment":{"default":true,"description":"(Optional) Boolean flag to specify whether Azure Virtual Machines are permitted to retrieve certificates stored as secrets from the key vault. Defaults to false."},"key_vault_enabled_for_disk_encryption":{"default":true,"description":" (Optional) Boolean flag to specify whether Azure Disk Encryption is permitted to retrieve secrets from the vault and unwrap keys. Defaults to false."},"key_vault_enabled_for_template_deployment":{"default":true,"description":"(Optional) Boolean flag to specify whether Azure Resource Manager is permitted to retrieve secrets from the key vault. Defaults to false."},"key_vault_name":{"default":"KeyVault","description":"Specifies the name of the key vault."},"key_vault_purge_protection_enabled":{"default":false,"description":"(Optional) Is Purge Protection enabled for this Key Vault? Defaults to false."},"key_vault_sku_name":{"default":"standard","description":"(Required) The Name of the SKU used for this Key Vault. Possible values are standard and premium."},"key_vault_soft_delete_retention_days":{"default":30,"description":"(Optional) The number of days that items should be retained for once soft-deleted. This value can be between 7 and 90 (the default) days."},"kubernetes_version":{"default":"1.26.3","description":"Specifies the AKS Kubernetes version"},"location":{"default":"East US","description":"Specifies the location for the resource group and all the resources"},"log_analytics_retention_days":{"default":30,"description":"Specifies the number of days of the retention policy"},"log_analytics_workspace_name":{"default":"Workspace","description":"Specifies the name of the log analytics workspace"},"name_prefix":{"default":"Bingo","description":"(Optional) A prefix for the name of all the resource groups and resources."},"namespace":{"default":"magic8ball","description":"Specifies the namespace of the workload application that accesses the Azure OpenAI Service."},"nat_gateway_idle_timeout_in_minutes":{"default":4,"description":"(Optional) The idle timeout which should be used in minutes. Defaults to 4."},"nat_gateway_name":{"default":"NatGateway","description":"(Required) Specifies the name of the Azure OpenAI Service"},"nat_gateway_sku_name":{"default":"Standard","description":"(Optional) The SKU which should be used. At this time the only supported value is Standard. Defaults to Standard"},"nat_gateway_zones":{"default":["1"],"description":" (Optional) A list of Availability Zones in which this NAT Gateway should be located. Changing this forces a new NAT Gateway to be created."},"network_dns_service_ip":{"default":"10.2.0.10","description":"Specifies the DNS service IP"},"network_plugin":{"default":"azure","description":"Specifies the network plugin of the AKS cluster"},"network_service_cidr":{"default":"10.2.0.0/24","description":"Specifies the service CIDR"},"oidc_issuer_enabled":{"default":true,"description":"(Optional) Enable or Disable the OIDC issuer URL."},"open_service_mesh_enabled":{"default":true,"description":"(Optional) Is Open Service Mesh enabled? For more details, please visit Open Service Mesh for AKS."},"openai_custom_subdomain_name":{"default":"","description":"(Optional) Specifies the custom subdomain name of the Azure OpenAI Service"},"openai_deployments":{"default":[{"model":{"name":"gpt-35-turbo","version":"0301"},"name":"gpt-35-turbo","rai_policy_name":""}],"description":"(Optional) Specifies the deployments of the Azure OpenAI Service"},"openai_name":{"default":"OpenAi","description":"(Required) Specifies the name of the Azure OpenAI Service"},"openai_public_network_access_enabled":{"default":true,"description":"(Optional) Specifies whether public network access is allowed for the Azure OpenAI Service"},"openai_sku_name":{"default":"S0","description":"(Optional) Specifies the sku name for the Azure OpenAI Service"},"pod_subnet_address_prefix":{"default":["10.242.0.0/16"],"description":"Specifies the address prefix of the jumbox subnet"},"pod_subnet_name":{"default":"PodSubnet","description":"Specifies the name of the jumpbox subnet"},"private_cluster_enabled":{"default":false,"description":"(Optional) Specifies wether the AKS cluster be private or not."},"resource_group_name":{"default":"RG","description":"Specifies the resource group name"},"role_based_access_control_enabled":{"default":true,"description":"(Required) Is Role Based Access Control Enabled? Changing this forces a new resource to be created."},"service_account_name":{"default":"magic8ball-sa","description":"Specifies the name of the service account of the workload application that accesses the Azure OpenAI Service."},"sku_tier":{"default":"Free","description":"(Optional) The SKU Tier that should be used for this Kubernetes Cluster. Possible values are Free and Paid (which includes the Uptime SLA). Defaults to Free."},"solution_plan_map":{"default":{"ContainerInsights":{"product":"OMSGallery/ContainerInsights","publisher":"Microsoft"}},"description":"Specifies solutions to deploy to log analytics workspace"},"ssh_public_key":{"description":"(Required) Specifies the SSH public key for the jumpbox virtual machine and AKS worker nodes."},"storage_account_kind":{"default":"StorageV2","description":"(Optional) Specifies the account kind of the storage account"},"storage_account_replication_type":{"default":"LRS","description":"(Optional) Specifies the replication type of the storage account"},"storage_account_tier":{"default":"Standard","description":"(Optional) Specifies the account tier of the storage account"},"subdomain":{"default":"magic8ball","description":"Specifies the subdomain of the Kubernetes ingress object."},"system_node_pool_availability_zones":{"default":["1","2","3"],"description":"Specifies the availability zones of the system node pool"},"system_node_pool_enable_auto_scaling":{"default":true,"description":"(Optional) Whether to enable auto-scaler. Defaults to false."},"system_node_pool_enable_host_encryption":{"default":false,"description":"(Optional) Should the nodes in this Node Pool have host encryption enabled? Defaults to false."},"system_node_pool_enable_node_public_ip":{"default":false,"description":"(Optional) Should each node have a Public IP Address? Defaults to false. Changing this forces a new resource to be created."},"system_node_pool_max_count":{"default":10,"description":"(Required) The maximum number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be greater than or equal to min_count."},"system_node_pool_max_pods":{"default":50,"description":"(Optional) The maximum number of pods that can run on each agent. Changing this forces a new resource to be created."},"system_node_pool_min_count":{"default":3,"description":"(Required) The minimum number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be less than or equal to max_count."},"system_node_pool_name":{"default":"system","description":"Specifies the name of the system node pool"},"system_node_pool_node_count":{"default":3,"description":"(Optional) The initial number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be a value in the range min_count - max_count."},"system_node_pool_node_labels":{"default":{},"description":"(Optional) A list of Kubernetes taints which should be applied to nodes in the agent pool (e.g key=value:NoSchedule). Changing this forces a new resource to be created."},"system_node_pool_node_taints":{"default":[],"description":"(Optional) A map of Kubernetes labels which should be applied to nodes in this Node Pool. Changing this forces a new resource to be created."},"system_node_pool_os_disk_type":{"default":"Ephemeral","description":"(Optional) The type of disk which should be used for the Operating System. Possible values are Ephemeral and Managed. Defaults to Managed. Changing this forces a new resource to be created."},"system_node_pool_subnet_address_prefix":{"default":["10.240.0.0/16"],"description":"Specifies the address prefix of the subnet that hosts the system node pool"},"system_node_pool_subnet_name":{"default":"SystemSubnet","description":"Specifies the name of the subnet that hosts the system node pool"},"system_node_pool_vm_size":{"default":"Standard_F8s_v2","description":"Specifies the vm size of the system node pool"},"tags":{"default":{"createdWith":"Terraform"},"description":"(Optional) Specifies tags for all the resources"},"user_node_pool_availability_zones":{"default":["1","2","3"],"description":"(Optional) A list of Availability Zones where the Nodes in this Node Pool should be created in. Changing this forces a new resource to be created."},"user_node_pool_enable_auto_scaling":{"default":true,"description":"(Optional) Whether to enable auto-scaler. Defaults to false."},"user_node_pool_enable_host_encryption":{"default":false,"description":"(Optional) Should the nodes in this Node Pool have host encryption enabled? Defaults to false."},"user_node_pool_enable_node_public_ip":{"default":false,"description":"(Optional) Should each node have a Public IP Address? Defaults to false. Changing this forces a new resource to be created."},"user_node_pool_max_count":{"default":10,"description":"(Required) The maximum number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be greater than or equal to min_count."},"user_node_pool_max_pods":{"default":50,"description":"(Optional) The maximum number of pods that can run on each agent. Changing this forces a new resource to be created."},"user_node_pool_min_count":{"default":3,"description":"(Required) The minimum number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be less than or equal to max_count."},"user_node_pool_mode":{"default":"User","description":"(Optional) Should this Node Pool be used for System or User resources? Possible values are System and User. Defaults to User."},"user_node_pool_name":{"default":"user","description":"(Required) Specifies the name of the node pool."},"user_node_pool_node_count":{"default":3,"description":"(Optional) The initial number of nodes which should exist within this Node Pool. Valid values are between 0 and 1000 and must be a value in the range min_count - max_count."},"user_node_pool_node_labels":{"default":{},"description":"(Optional) A list of Kubernetes taints which should be applied to nodes in the agent pool (e.g key=value:NoSchedule). Changing this forces a new resource to be created."},"user_node_pool_node_taints":{"default":["CriticalAddonsOnly=true:NoSchedule"],"description":"(Optional) A map of Kubernetes labels which should be applied to nodes in this Node Pool. Changing this forces a new resource to be created."},"user_node_pool_os_disk_type":{"default":"Ephemeral","description":"(Optional) The type of disk which should be used for the Operating System. Possible values are Ephemeral and Managed. Defaults to Managed. Changing this forces a new resource to be created."},"user_node_pool_os_type":{"default":"Linux","description":"(Optional) The Operating System which should be used for this Node Pool. Changing this forces a new resource to be created. Possible values are Linux and Windows. Defaults to Linux."},"user_node_pool_priority":{"default":"Regular","description":"(Optional) The Priority for Virtual Machines within the Virtual Machine Scale Set that powers this Node Pool. Possible values are Regular and Spot. Defaults to Regular. Changing this forces a new resource to be created."},"user_node_pool_subnet_address_prefix":{"default":["10.241.0.0/16"],"description":"Specifies the address prefix of the subnet that hosts the user node pool"},"user_node_pool_subnet_name":{"default":"UserSubnet","description":"Specifies the name of the subnet that hosts the user node pool"},"user_node_pool_vm_size":{"default":"Standard_F8s_v2","description":"(Required) The SKU which should be used for the Virtual Machines used in this Node Pool. Changing this forces a new resource to be created."},"vertical_pod_autoscaler_enabled":{"default":true,"description":"(Optional) Specifies whether Vertical Pod Autoscaler should be enabled."},"vm_enabled":{"default":false,"description":"(Optional) Specifies whether create a virtual machine"},"vm_name":{"default":"Vm","description":"Specifies the name of the jumpbox virtual machine"},"vm_os_disk_image":{"default":{"offer":"0001-com-ubuntu-server-jammy","publisher":"Canonical","sku":"22_04-lts-gen2","version":"latest"},"description":"Specifies the os disk image of the virtual machine"},"vm_os_disk_storage_account_type":{"default":"Premium_LRS","description":"Specifies the storage account type of the os disk of the jumpbox virtual machine"},"vm_public_ip":{"default":false,"description":"(Optional) Specifies whether create a public IP for the virtual machine"},"vm_size":{"default":"Standard_DS1_v2","description":"Specifies the size of the jumpbox virtual machine"},"vm_subnet_address_prefix":{"default":["10.243.1.0/24"],"description":"Specifies the address prefix of the jumbox subnet"},"vm_subnet_name":{"default":"VmSubnet","description":"Specifies the name of the jumpbox subnet"},"vnet_address_space":{"default":["10.0.0.0/8"],"description":"Specifies the address prefix of the AKS subnet"},"vnet_name":{"default":"AksVNet","description":"Specifies the name of the AKS subnet"},"workload_identity_enabled":{"default":true,"description":"(Optional) Specifies whether Azure AD Workload Identity should be enabled for the Cluster. Defaults to false."},"workload_managed_identity_name":{"default":"WorkloadManagedIdentity","description":"(Required) Specifies the name of the workload user-defined managed identity."}}}},"timestamp":"2023-08-29T19:55:04Z"}
